var st=Object.defineProperty;var me=Object.getOwnPropertySymbols;var Ne=Object.prototype.hasOwnProperty,Te=Object.prototype.propertyIsEnumerable;var Me=(e,t,o)=>t in e?st(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Y=(e,t)=>{for(var o in t||(t={}))Ne.call(t,o)&&Me(e,o,t[o]);if(me)for(var o of me(t))Te.call(t,o)&&Me(e,o,t[o]);return e};var de=(e,t)=>{var o={};for(var n in e)Ne.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(e!=null&&me)for(var n of me(e))t.indexOf(n)<0&&Te.call(e,n)&&(o[n]=e[n]);return o};import{f as ct,g as E,h as ut,i as ze,j as L,k as Je,l as Se,m as W,n as ve,p as Ke,q as mt,d as G,r as T,o as d,c as g,a as w,b as F,t as S,s as x,u as J,F as H,v as Z,x as Be,y as dt,z as pt,A as gt,B as ie,C as Ie,D as ht,E as vt,G as ye,H as ft}from"./app.27ec4c30.js";var X,pe,le=typeof Map=="function"?new Map:(X=[],pe=[],{has:function(e){return X.indexOf(e)>-1},get:function(e){return pe[X.indexOf(e)]},set:function(e,t){X.indexOf(e)===-1&&(X.push(e),pe.push(t))},delete:function(e){var t=X.indexOf(e);t>-1&&(X.splice(t,1),pe.splice(t,1))}}),Ye=function(e){return new Event(e,{bubbles:!0})};try{new Event("test")}catch{Ye=function(t){var o=document.createEvent("Event");return o.initEvent(t,!0,!1),o}}function yt(e){var t=le.get(e);t&&t.destroy()}function wt(e){var t=le.get(e);t&&t.update()}var ae=null;typeof window=="undefined"||typeof window.getComputedStyle!="function"?((ae=function(e){return e}).destroy=function(e){return e},ae.update=function(e){return e}):((ae=function(e,t){return e&&Array.prototype.forEach.call(e.length?e:[e],function(o){return function(n){if(n&&n.nodeName&&n.nodeName==="TEXTAREA"&&!le.has(n)){var u,s=null,m=null,a=null,i=function(){n.clientWidth!==m&&r()},l=function(k){window.removeEventListener("resize",i,!1),n.removeEventListener("input",r,!1),n.removeEventListener("keyup",r,!1),n.removeEventListener("autosize:destroy",l,!1),n.removeEventListener("autosize:update",r,!1),Object.keys(k).forEach(function(c){n.style[c]=k[c]}),le.delete(n)}.bind(n,{height:n.style.height,resize:n.style.resize,overflowY:n.style.overflowY,overflowX:n.style.overflowX,wordWrap:n.style.wordWrap});n.addEventListener("autosize:destroy",l,!1),"onpropertychange"in n&&"oninput"in n&&n.addEventListener("keyup",r,!1),window.addEventListener("resize",i,!1),n.addEventListener("input",r,!1),n.addEventListener("autosize:update",r,!1),n.style.overflowX="hidden",n.style.wordWrap="break-word",le.set(n,{destroy:l,update:r}),(u=window.getComputedStyle(n,null)).resize==="vertical"?n.style.resize="none":u.resize==="both"&&(n.style.resize="horizontal"),s=u.boxSizing==="content-box"?-(parseFloat(u.paddingTop)+parseFloat(u.paddingBottom)):parseFloat(u.borderTopWidth)+parseFloat(u.borderBottomWidth),isNaN(s)&&(s=0),r()}function v(k){var c=n.style.width;n.style.width="0px",n.style.width=c,n.style.overflowY=k}function b(){if(n.scrollHeight!==0){var k=function(f){for(var $=[];f&&f.parentNode&&f.parentNode instanceof Element;)f.parentNode.scrollTop&&$.push({node:f.parentNode,scrollTop:f.parentNode.scrollTop}),f=f.parentNode;return $}(n),c=document.documentElement&&document.documentElement.scrollTop;n.style.height="",n.style.height=n.scrollHeight+s+"px",m=n.clientWidth,k.forEach(function(f){f.node.scrollTop=f.scrollTop}),c&&(document.documentElement.scrollTop=c)}}function r(){b();var k=Math.round(parseFloat(n.style.height)),c=window.getComputedStyle(n,null),f=c.boxSizing==="content-box"?Math.round(parseFloat(c.height)):n.offsetHeight;if(f<k?c.overflowY==="hidden"&&(v("scroll"),b(),f=c.boxSizing==="content-box"?Math.round(parseFloat(window.getComputedStyle(n,null).height)):n.offsetHeight):c.overflowY!=="hidden"&&(v("hidden"),b(),f=c.boxSizing==="content-box"?Math.round(parseFloat(window.getComputedStyle(n,null).height)):n.offsetHeight),a!==f){a=f;var $=Ye("autosize:resized");try{n.dispatchEvent($)}catch{}}}}(o)}),e}).destroy=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],yt),e},ae.update=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],wt),e});var Oe=ae,Xe={exports:{}};(function(e,t){(function(o,n){e.exports=n()})(ct,function(){function o(a,i){return i={exports:{}},a(i,i.exports),i.exports}var n=o(function(a){var i=a.exports=function(){return new RegExp("(?:"+i.line().source+")|(?:"+i.block().source+")","gm")};i.line=function(){return/(?:^|\s)\/\/(.+?)$/gm},i.block=function(){return/\/\*([\S\s]*?)\*\//gm}}),u=["23AC69","91C132","F19726","E8552D","1AAB8E","E1147F","2980C1","1BA1E6","9FA0A0","F19726","E30B20","E30B20","A3338B"],s=function(a,i){i===void 0&&(i={});var l=i.colors;l===void 0&&(l=u);var v=0,b={},r=/[\u4E00-\u9FFF\u3400-\u4dbf\uf900-\ufaff\u3040-\u309f\uac00-\ud7af\u0400-\u04FF]+|\w+/,k=/</,c=new RegExp("("+r.source+"|"+k.source+")|("+n().source+")","gmi");return a.replace(c,function(f,$,U){if(U)return m(U);if($==="<")return"&lt;";var I;b[$]?I=b[$]:(I=l[v],b[$]=I);var M='<span style="color: #'+I+'">'+$+"</span>";return v=++v%l.length,M})};function m(a){return'<span style="color: slategray">'+a+"</span>"}return s})})(Xe);var bt=Xe.exports;const kt=["nick","mail","link"],Pe=e=>e.filter(t=>kt.includes(t)),Kn="zh-CN",Ct=e=>new Promise((t,o)=>{const n=new FileReader;n.readAsDataURL(e),n.onload=()=>{var u;return t(((u=n.result)==null?void 0:u.toString())||"")},n.onerror=o}),$t=e=>e===!0?'<p class="vtex">Tex is not available in preview</p>':'<span class="vtex">Tex is not available in preview</span>',xt=["nick","nickError","mail","mailError","link","optional","placeholder","sofa","submit","reply","cancelReply","comment","refresh","more","preview","emoji","uploadImage","seconds","minutes","hours","days","now","uploading","login","logout","admin","sticky","word","wordHint","anonymous"],ee=e=>Object.fromEntries(e.map((t,o)=>[xt[o],t]));var we=ee(["NickName","NickName cannot be less than 3 bytes.","E-Mail","Please confirm your email address.","Website","Optional","Comment here...","No comment yet.","Submit","Reply","Cancel reply","Comments","Refresh","Load More...","Preview","Emoji","Upload Image","seconds ago","minutes ago","hours ago","days ago","just now","Uploading","Login","logout","Admin","Sticky","Words",`Please input comments between $0 and $1 words!
 Current word number: $2`,"Anonymous"]),be=ee(["\u30CB\u30C3\u30AF\u30CD\u30FC\u30E0","3\u30D0\u30A4\u30C8\u4EE5\u4E0A\u306E\u30CB\u30C3\u30AF\u30CD\u30FC\u30E0\u3092\u3054\u5165\u529B\u304F\u3060\u3055\u3044.","\u30E1\u30FC\u30EB\u30A2\u30C9\u30EC\u30B9","\u30E1\u30FC\u30EB\u30A2\u30C9\u30EC\u30B9\u3092\u3054\u78BA\u8A8D\u304F\u3060\u3055\u3044.","\u30B5\u30A4\u30C8","\u30AA\u30D7\u30B7\u30E7\u30F3","\u3053\u3053\u306B\u30B3\u30E1\u30F3\u30C8","\u30B3\u30E1\u30F3\u30C8\u3057\u307E\u3057\u3087\u3046~","\u63D0\u51FA\u3059\u308B","\u8FD4\u4FE1\u3059\u308B","\u30AD\u30E3\u30F3\u30BB\u30EB","\u30B3\u30E1\u30F3\u30C8","\u66F4\u65B0","\u3055\u3089\u306B\u8AAD\u307F\u8FBC\u3080","\u30D7\u30EC\u30D3\u30E5\u30FC","\u7D75\u6587\u5B57","\u753B\u50CF\u3092\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9","\u79D2\u524D","\u5206\u524D","\u6642\u9593\u524D","\u65E5\u524D","\u305F\u3063\u3060\u4ECA","\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9","\u30ED\u30B0\u30A4\u30F3\u3059\u308B","\u30ED\u30B0\u30A2\u30A6\u30C8","\u7BA1\u7406\u8005","\u30C8\u30C3\u30D7\u306B\u7F6E\u304F","\u30EF\u30FC\u30C9",`\u30B3\u30E1\u30F3\u30C8\u306F $0 \u304B\u3089 $1 \u30EF\u30FC\u30C9\u306E\u9593\u3067\u306A\u3051\u308C\u3070\u306A\u308A\u307E\u305B\u3093!
 \u73FE\u5728\u306E\u5358\u8A9E\u756A\u53F7: $2`,"\u533F\u540D"]),ke=ee(["\u6635\u79F0","\u6635\u79F0\u4E0D\u80FD\u5C11\u4E8E3\u4E2A\u5B57\u7B26","\u90AE\u7BB1","\u8BF7\u586B\u5199\u6B63\u786E\u7684\u90AE\u4EF6\u5730\u5740","\u7F51\u5740","\u53EF\u9009","\u6B22\u8FCE\u8BC4\u8BBA","\u6765\u53D1\u8BC4\u8BBA\u5427~","\u63D0\u4EA4","\u56DE\u590D","\u53D6\u6D88\u56DE\u590D","\u8BC4\u8BBA","\u5237\u65B0","\u52A0\u8F7D\u66F4\u591A...","\u9884\u89C8","\u8868\u60C5","\u4E0A\u4F20\u56FE\u7247","\u79D2\u524D","\u5206\u949F\u524D","\u5C0F\u65F6\u524D","\u5929\u524D","\u521A\u521A","\u6B63\u5728\u4E0A\u4F20","\u767B\u5F55","\u9000\u51FA","\u535A\u4E3B","\u7F6E\u9876","\u5B57",`\u8BC4\u8BBA\u5B57\u6570\u5E94\u5728 $0 \u5230 $1 \u5B57\u4E4B\u95F4\uFF01
\u5F53\u524D\u5B57\u6570\uFF1A$2`,"\u533F\u540D"]),Fe=ee(["\u66B1\u7A31","\u90F5\u7BB1","\u7DB2\u5740","\u53EF\u9078","\u66B1\u7A31\u4E0D\u80FD\u5C11\u65BC3\u500B\u5B57\u5143","\u8ACB\u586B\u5BEB\u6B63\u78BA\u7684\u90F5\u4EF6\u5730\u5740","\u6B61\u8FCE\u8A55\u8AD6","\u4F86\u767C\u8A55\u8AD6\u5427~","\u63D0\u4EA4","\u56DE\u8986","\u53D6\u6D88\u56DE\u8986","\u8A55\u8AD6","\u5237\u65B0","\u8F09\u5165\u66F4\u591A...","\u9810\u89BD","\u8868\u60C5","\u4E0A\u50B3\u5716\u7247","\u79D2\u524D","\u5206\u9418\u524D","\u5C0F\u6642\u524D","\u5929\u524D","\u525B\u525B","\u6B63\u5728\u4E0A\u50B3","\u767B\u9304","\u9000\u51FA","\u535A\u4E3B","\u7F6E\u9802","\u5B57",`\u8A55\u8AD6\u5B57\u6578\u61C9\u5728 $0 \u5230 $1 \u5B57\u4E4B\u9593\uFF01
\u7576\u524D\u5B57\u6578\uFF1A$2`,"\u533F\u540D"]),He=ee(["Apelido","Apelido n\xE3o pode ser menor que 3 bytes.","E-Mail","Por favor, confirme seu endere\xE7o de e-mail.","Website","Opcional","Comente aqui...","Nenhum coment\xE1rio, ainda.","Enviar","Responder","Cancelar resposta","Coment\xE1rios","Refrescar","Carregar Mais...","Visualizar","Emoji","Enviar Imagem","segundos atr\xE1s","minutos atr\xE1s","horas atr\xE1s","dias atr\xE1s","agora mesmo","Enviando","Entrar","Sair","Admin","Sticky","Palavras",`Favor enviar coment\xE1rio com $0 a $1 palavras!
 N\xFAmero de palavras atuais: $2`,"An\xF4nimo"]),Ce=ee(["\u041F\u0441\u0435\u0432\u0434\u043E\u043D\u0438\u043C","\u041D\u0438\u043A\u043D\u0435\u0439\u043C \u043D\u0435 \u043C\u043E\u0436\u0435\u0442 \u0431\u044B\u0442\u044C \u043C\u0435\u043D\u044C\u0448\u0435 3 \u0431\u0430\u0439\u0442.","\u042D\u043B. \u0430\u0434\u0440\u0435\u0441","\u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u0430\u0434\u0440\u0435\u0441 \u0432\u0430\u0448\u0435\u0439 \u044D\u043B\u0435\u043A\u0442\u0440\u043E\u043D\u043D\u043E\u0439 \u043F\u043E\u0447\u0442\u044B.","\u0412\u0435\u0431-\u0441\u0430\u0439\u0442","\u041D\u0435\u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u044B\u0439","\u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439 \u0437\u0434\u0435\u0441\u044C...","\u041F\u043E\u043A\u0430 \u043D\u0435\u0442 \u043A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0435\u0432.","\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C","\u041E\u0442\u0432\u0435\u0447\u0430\u0442\u044C","\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C \u043E\u0442\u0432\u0435\u0442","\u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0438","\u041E\u0431\u043D\u043E\u0432\u0438\u0442\u044C","\u0417\u0430\u0433\u0440\u0443\u0437\u0438 \u0431\u043E\u043B\u044C\u0448\u0435...","\u041F\u0440\u0435\u0432\u044C\u044E","\u044D\u043C\u043E\u0434\u0437\u0438","\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435","\u0441\u0435\u043A\u0443\u043D\u0434 \u043D\u0430\u0437\u0430\u0434","\u043D\u0435\u0441\u043A\u043E\u043B\u044C\u043A\u043E \u043C\u0438\u043D\u0443\u0442 \u043D\u0430\u0437\u0430\u0434","\u043D\u0435\u0441\u043A\u043E\u043B\u044C\u043A\u043E \u0447\u0430\u0441\u043E\u0432 \u043D\u0430\u0437\u0430\u0434","\u0434\u043D\u0435\u0439 \u043D\u0430\u0437\u0430\u0434","\u043F\u0440\u044F\u043C\u043E \u0441\u0435\u0439\u0447\u0430\u0441","\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430","\u0410\u0432\u0442\u043E\u0440\u0438\u0437\u043E\u0432\u0430\u0442\u044C\u0441\u044F","\u0412\u044B\u0445\u043E\u0434 \u0438\u0437 \u0441\u0438\u0441\u0442\u0435\u043C\u044B","\u0410\u0434\u043C\u0438\u043D","\u041B\u0438\u043F\u043A\u0438\u0439","\u0421\u043B\u043E\u0432\u0430",`\u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0438 \u043E\u0442 $0 \u0434\u043E $1 \u0441\u043B\u043E\u0432!
\u041D\u043E\u043C\u0435\u0440 \u0442\u0435\u043A\u0443\u0449\u0435\u0433\u043E \u0441\u043B\u043E\u0432\u0430: $2`,"\u0410\u043D\u043E\u043D\u0438\u043C\u043D\u044B\u0439"]);const We={zh:ke,"zh-cn":ke,"zh-CN":ke,"zh-tw":Fe,"zh-TW":Fe,en:we,"en-US":we,"en-us":we,jp:be,"jp-jp":be,"jp-JP":be,"pt-br":He,"pt-BR":He,ru:Ce,"ru-ru":Ce,"ru-RU":Ce},Ge=e=>{let t={};const o=localStorage.getItem(e);if(o)try{t=JSON.parse(o)}catch{}return{get:n=>t[n]||null,set(n,u){try{t[n]=JSON.parse(JSON.stringify(u)),localStorage.setItem(e,JSON.stringify(t))}catch{}},update(n){t=JSON.parse(JSON.stringify(n)),localStorage.setItem(e,JSON.stringify(t))}}};let re,$e;const Et=()=>($e||(re=Ge("WALINE_USER_CACHE"),$e=Se({nick:re.get("nick")||"",mail:re.get("mail")||"",link:re.get("link")||"",editor:""})),{inputs:$e,store:re}),Qe=e=>{try{e=decodeURI(e)}catch{}return e},Ze=(e="")=>e.replace(/\/$/u,""),et=e=>/^(https?:)?\/\//.test(e);let ge;const Lt=e=>{ge||(ge=Ge("WALINE_EMOJI"));const t=Boolean(/@[0-9]+\.[0-9]+\.[0-9]+/.test(e));if(t){const o=ge.get(e);if(o)return Promise.resolve(o)}return fetch(`${e}/info.json`).then(o=>o.json()).then(o=>{const n=Y({folder:e},o);return t&&ge.set(e,n),n})},_e=(e,t,o="",n="")=>`${t}/${o}${e}${n?`.${n}`:""}`,St=e=>{const t=Ze(e);return et(t)?t:`https://${t}`},xe=(e,t)=>typeof e=="function"?e:e!==!1&&t,Ee="{--waline-white:#000;--waline-light-grey:#666;--waline-dark-grey:#999;--waline-color:#888;--waline-bgcolor:#1e1e1e;--waline-bgcolor-light:#272727;--waline-bgcolor-hover: #444;--waline-border-color:#333;--waline-disable-bgcolor:#444;--waline-disable-color:#272727;--waline-bq-color:#272727;--waline-info-bgcolor:#272727;--waline-info-color:#666}",It=e=>e.type.includes("image"),De=e=>{const t=Array.from(e).find(It);return t?t.getAsFile():null},tt=e=>{e.name!=="AbortError"&&console.error(e.message)},se=(e,t="")=>{if(typeof e=="object"&&e.errno)throw new TypeError(`Fetch ${t} failed with ${e.errno}: ${e.errmsg}`);return e},Rt=({serverURL:e,paths:t,signal:o})=>fetch(`${e}/article?path=${encodeURIComponent(t.join(","))}`,{signal:o}).then(n=>n.json()).then(n=>se(n,"visit count")).then(n=>Array.isArray(n)?n:[n]),jt=({serverURL:e,path:t})=>fetch(`${e}/article`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:t})}).then(o=>o.json()).then(o=>se(o,"visit count")),nt=e=>e instanceof HTMLElement?e:typeof e=="string"?document.querySelector(e):null,zt=/\$.*?\$/,At=/^\$(.*?)\$/,Ut=/^(?:\s{0,3})\$\$((?:[^\n]|\n[^\n])+?)\n{0,1}\$\$/,ot=(e="",t={})=>e.replace(/:(.+?):/g,(o,n)=>t[n]?`<img class="vemoji" src="${t[n]}" alt="${n}">`:o),Mt=(e,{emojiMap:t,highlighter:o,texRenderer:n})=>{if(ye.setOptions({highlight:o||void 0,breaks:!0,smartLists:!0,smartypants:!0}),n){const u=(s=>[{name:"blockMath",level:"block",tokenizer(m){const a=Ut.exec(m);if(a!==null)return{type:"html",raw:a[0],text:s(!0,a[1])}}},{name:"inlineMath",level:"inline",start(m){const a=m.search(zt);return a!==-1?a:m.length},tokenizer(m){const a=At.exec(m);if(a!==null)return{type:"html",raw:a[0],text:s(!1,a[1])}}}])(n);ye.use({extensions:u})}return ye.parse(ot(e,t))},Ve=e=>e.dataset.path||e.getAttribute("id"),Le=(e,t)=>{let o=e.toString();for(;o.length<t;)o="0"+o;return o},Nt=(e,t)=>{if(e)try{typeof e=="string"&&(e=new Date(e.indexOf(" ")!==-1?e.replace(/-/g,"/"):e));const o=e.getTime(),n=new Date().getTime()-o,u=Math.floor(n/864e5);if(u===0){const s=n%864e5,m=Math.floor(s/36e5);if(m===0){const a=s%36e5,i=Math.floor(a/6e4);if(i===0){const l=a%6e4;return`${Math.round(l/1e3)} ${t.seconds}`}return`${i} ${t.minutes}`}return`${m} ${t.hours}`}return u<0?t.now:u<8?`${u} ${t.days}`:(s=>{const m=Le(s.getDate(),2),a=Le(s.getMonth()+1,2);return`${Le(s.getFullYear(),2)}-${a}-${m}`})(e)}catch(o){console.log(o)}return""},rt=()=>{try{const e=localStorage.getItem("WALINE_USER"),t=sessionStorage.getItem("WALINE_USER");return e?JSON.parse(e):t?JSON.parse(t):null}catch{return null}},he=E({}),Ae=()=>{if(!he.value.token){const e=rt();e&&(he.value=e)}return{userInfo:ut(he),setUserInfo:e=>{he.value=e}}},Tt=({serverURL:e,path:t=window.location.pathname,selector:o=".waline-comment-count"})=>{var m;const n=new AbortController,u=document.querySelectorAll(o),{userInfo:s}=Ae();return u.length&&(({serverURL:a,paths:i,signal:l,token:v})=>{const b={};return v&&(b.Authorization=`Bearer ${v}`),fetch(`${a}/comment?type=count&url=${encodeURIComponent(i.join(","))}`,{signal:l,headers:b}).then(r=>r.json()).then(r=>se(r,"comment count")).then(r=>Array.isArray(r)?r:[r])})({serverURL:e,paths:Array.from(u).map(a=>Qe(a.dataset.path||a.getAttribute("id")||t)),signal:n.signal,token:(m=s.value)==null?void 0:m.token}).then(a=>{u.forEach((i,l)=>{i.innerText=a[l].toString()})}).catch(tt),n.abort.bind(n)},at=({size:e})=>L("svg",{width:e,height:e,viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid"},L("circle",{cx:50,cy:50,fill:"none",stroke:"currentColor",strokeWidth:"4",r:"40","stroke-dasharray":"85 30"},L("animateTransform",{attributeName:"transform",type:"rotate",repeatCount:"indefinite",dur:"1s",values:"0 50 50;360 50 50",keyTimes:"0;1"})));var fe=ze({name:"CommentBox",components:{CloseIcon:({size:e})=>L("svg",{class:"vclose-icon",viewBox:"0 0 1024 1024",width:e,height:e},[L("path",{d:"M697.173 85.333h-369.92c-144.64 0-241.92 101.547-241.92 252.587v348.587c0 150.613 97.28 252.16 241.92 252.16h369.92c144.64 0 241.494-101.547 241.494-252.16V337.92c0-151.04-96.854-252.587-241.494-252.587z",fill:"currentColor"}),L("path",{d:"m640.683 587.52-75.947-75.861 75.904-75.862a37.29 37.29 0 0 0 0-52.778 37.205 37.205 0 0 0-52.779 0l-75.946 75.818-75.862-75.946a37.419 37.419 0 0 0-52.821 0 37.419 37.419 0 0 0 0 52.821l75.947 75.947-75.776 75.733a37.29 37.29 0 1 0 52.778 52.821l75.776-75.776 75.947 75.947a37.376 37.376 0 0 0 52.779-52.821z",fill:"#888"})]),EmojiIcon:()=>L("svg",{viewBox:"0 0 1024 1024",width:"24",height:"24"},L("path",{d:"M563.2 463.3 677 540c1.7 1.2 3.7 1.8 5.8 1.8.7 0 1.4-.1 2-.2 2.7-.5 5.1-2.1 6.6-4.4l25.3-37.8c1.5-2.3 2.1-5.1 1.6-7.8s-2.1-5.1-4.4-6.6l-73.6-49.1 73.6-49.1c2.3-1.5 3.9-3.9 4.4-6.6.5-2.7 0-5.5-1.6-7.8l-25.3-37.8a10.1 10.1 0 0 0-6.6-4.4c-.7-.1-1.3-.2-2-.2-2.1 0-4.1.6-5.8 1.8l-113.8 76.6c-9.2 6.2-14.7 16.4-14.7 27.5.1 11 5.5 21.3 14.7 27.4zM387 348.8h-45.5c-5.7 0-10.4 4.7-10.4 10.4v153.3c0 5.7 4.7 10.4 10.4 10.4H387c5.7 0 10.4-4.7 10.4-10.4V359.2c0-5.7-4.7-10.4-10.4-10.4zm333.8 241.3-41-20a10.3 10.3 0 0 0-8.1-.5c-2.6.9-4.8 2.9-5.9 5.4-30.1 64.9-93.1 109.1-164.4 115.2-5.7.5-9.9 5.5-9.5 11.2l3.9 45.5c.5 5.3 5 9.5 10.3 9.5h.9c94.8-8 178.5-66.5 218.6-152.7 2.4-5 .3-11.2-4.8-13.6zm186-186.1c-11.9-42-30.5-81.4-55.2-117.1-24.1-34.9-53.5-65.6-87.5-91.2-33.9-25.6-71.5-45.5-111.6-59.2-41.2-14-84.1-21.1-127.8-21.1h-1.2c-75.4 0-148.8 21.4-212.5 61.7-63.7 40.3-114.3 97.6-146.5 165.8-32.2 68.1-44.3 143.6-35.1 218.4 9.3 74.8 39.4 145 87.3 203.3.1.2.3.3.4.5l36.2 38.4c1.1 1.2 2.5 2.1 3.9 2.6 73.3 66.7 168.2 103.5 267.5 103.5 73.3 0 145.2-20.3 207.7-58.7 37.3-22.9 70.3-51.5 98.1-85 27.1-32.7 48.7-69.5 64.2-109.1 15.5-39.7 24.4-81.3 26.6-123.8 2.4-43.6-2.5-87-14.5-129zm-60.5 181.1c-8.3 37-22.8 72-43 104-19.7 31.1-44.3 58.6-73.1 81.7-28.8 23.1-61 41-95.7 53.4-35.6 12.7-72.9 19.1-110.9 19.1-82.6 0-161.7-30.6-222.8-86.2l-34.1-35.8c-23.9-29.3-42.4-62.2-55.1-97.7-12.4-34.7-18.8-71-19.2-107.9-.4-36.9 5.4-73.3 17.1-108.2 12-35.8 30-69.2 53.4-99.1 31.7-40.4 71.1-72 117.2-94.1 44.5-21.3 94-32.6 143.4-32.6 49.3 0 97 10.8 141.8 32 34.3 16.3 65.3 38.1 92 64.8 26.1 26 47.5 56 63.6 89.2 16.2 33.2 26.6 68.5 31 105.1 4.6 37.5 2.7 75.3-5.6 112.3z",fill:"currentColor"})),ImageIcon:()=>L("svg",{viewBox:"0 0 1024 1024",width:"24",height:"24"},[L("path",{d:"M784 112H240c-88 0-160 72-160 160v480c0 88 72 160 160 160h544c88 0 160-72 160-160V272c0-88-72-160-160-160zm96 640c0 52.8-43.2 96-96 96H240c-52.8 0-96-43.2-96-96V272c0-52.8 43.2-96 96-96h544c52.8 0 96 43.2 96 96v480z",fill:"currentColor"}),L("path",{d:"M352 480c52.8 0 96-43.2 96-96s-43.2-96-96-96-96 43.2-96 96 43.2 96 96 96zm0-128c17.6 0 32 14.4 32 32s-14.4 32-32 32-32-14.4-32-32 14.4-32 32-32zm462.4 379.2-3.2-3.2-177.6-177.6c-25.6-25.6-65.6-25.6-91.2 0l-80 80-36.8-36.8c-25.6-25.6-65.6-25.6-91.2 0L200 728c-4.8 6.4-8 14.4-8 24 0 17.6 14.4 32 32 32 9.6 0 16-3.2 22.4-9.6L380.8 640l134.4 134.4c6.4 6.4 14.4 9.6 24 9.6 17.6 0 32-14.4 32-32 0-9.6-4.8-17.6-9.6-24l-52.8-52.8 80-80L769.6 776c6.4 4.8 12.8 8 20.8 8 17.6 0 32-14.4 32-32 0-8-3.2-16-8-20.8z",fill:"currentColor"})]),MarkdownIcon:()=>L("svg",{width:"16",height:"16",ariaHidden:"true"},L("path",{d:"M14.85 3H1.15C.52 3 0 3.52 0 4.15v7.69C0 12.48.52 13 1.15 13h13.69c.64 0 1.15-.52 1.15-1.15v-7.7C16 3.52 15.48 3 14.85 3zM9 11H7V8L5.5 9.92 4 8v3H2V5h2l1.5 2L7 5h2v6zm2.99.5L9.5 8H11V5h2v3h1.5l-2.51 3.5z",fill:"currentColor"})),PreviewIcon:()=>L("svg",{viewBox:"0 0 1024 1024",width:"24",height:"24"},[L("path",{d:"M710.816 654.301c70.323-96.639 61.084-230.578-23.705-314.843-46.098-46.098-107.183-71.109-172.28-71.109-65.008 0-126.092 25.444-172.28 71.109-45.227 46.098-70.756 107.183-70.756 172.106 0 64.923 25.444 126.007 71.194 172.106 46.099 46.098 107.184 71.109 172.28 71.109 51.414 0 100.648-16.212 142.824-47.404l126.53 126.006c7.058 7.06 16.297 10.979 26.406 10.979 10.105 0 19.343-3.919 26.402-10.979 14.467-14.467 14.467-38.172 0-52.723L710.816 654.301zm-315.107-23.265c-65.88-65.88-65.88-172.54 0-238.42 32.069-32.07 74.245-49.149 119.471-49.149 45.227 0 87.407 17.603 119.472 49.149 65.88 65.879 65.88 172.539 0 238.42-63.612 63.178-175.242 63.178-238.943 0zm0 0",fill:"currentColor"}),L("path",{d:"M703.319 121.603H321.03c-109.8 0-199.469 89.146-199.469 199.38v382.034c0 109.796 89.236 199.38 199.469 199.38h207.397c20.653 0 37.384-16.645 37.384-37.299 0-20.649-16.731-37.296-37.384-37.296H321.03c-68.582 0-124.352-55.77-124.352-124.267V321.421c0-68.496 55.77-124.267 124.352-124.267h382.289c68.582 0 124.352 55.771 124.352 124.267V524.72c0 20.654 16.736 37.299 37.385 37.299 20.654 0 37.384-16.645 37.384-37.299V320.549c-.085-109.8-89.321-198.946-199.121-198.946zm0 0",fill:"currentColor"})]),LoadingIcon:at},props:{rootId:{type:String,default:""},replyId:{type:String,default:""},replyUser:{type:String,default:""}},emits:["submit","cancel-reply"],setup(e,{emit:t}){const o=Je("config"),{inputs:n,store:u}=Et(),{userInfo:s,setUserInfo:m}=Ae(),a=E({}),i=E(null),l=E(null),v=E(null),b=E(null),r=E({tabs:[],map:{}}),k=E(0),c=E(!1),f=E(!1),$=E(""),U=E(0),I=E(0),M=E(!1),z=E(""),B=E(!1),N=W(()=>o.value.locale),te=W(()=>{var p;return Boolean((p=s.value)==null?void 0:p.token)}),_=W(()=>o.value.imageUploader!==!1),K=p=>{const h=i.value,C=h.selectionStart,j=h.selectionEnd||0,R=h.scrollTop;n.editor=h.value.substring(0,C)+p+h.value.substring(j,h.value.length),h.focus(),h.selectionStart=C+p.length,h.selectionEnd=C+p.length,h.scrollTop=R},D=p=>{const h=`![${o.value.locale.uploading} ${p.name}]()`;return K(h),Promise.resolve().then(()=>o.value.imageUploader(p)).then(C=>{n.editor=n.editor.replace(h,`\r
![${p.name}](${C})`)})},V=()=>{var O,A,q,Q,ne;const{serverURL:p,lang:h,login:C,wordLimit:j,requiredMeta:R}=o.value,y={comment:z.value,nick:n.nick,mail:n.mail,link:n.link,ua:navigator.userAgent,url:o.value.path};if((O=s.value)!=null&&O.token)y.nick=s.value.display_name,y.mail=s.value.email,y.link=s.value.url;else{if(C==="force")return;if((R.indexOf("nick")>-1||y.nick)&&!y.nick)return(A=a.value.nick)==null||A.focus(),alert(N.value.nickError);if(R.indexOf("mail")>-1&&!y.mail)return(q=a.value.mail)==null||q.focus(),alert(N.value.mailError);if(!y.comment)return void((Q=i.value)==null?void 0:Q.focus());y.nick||(y.nick=N.value.anonymous)}if(!M.value)return alert(N.value.wordHint.replace("$0",j[0].toString()).replace("$1",j[1].toString()).replace("$2",U.value.toString()));y.comment=ot(y.comment,r.value.map),e.replyId&&e.rootId&&(y.pid=e.replyId,y.rid=e.rootId,y.at=e.replyUser),B.value=!0,(({serverURL:P,lang:ue,token:oe,comment:lt})=>{const Ue={"Content-Type":"application/json"};return oe&&(Ue.Authorization=`Bearer ${oe}`),fetch(`${P}/comment?lang=${ue}`,{method:"POST",headers:Ue,body:JSON.stringify(lt)}).then(it=>it.json())})({serverURL:p,lang:h,token:(ne=s.value)==null?void 0:ne.token,comment:y}).then(P=>{if(B.value=!1,u.update({nick:y.nick,link:y.link,mail:y.mail}),P.errmsg)return alert(P.errmsg);t("submit",P.data),n.editor="",$.value="",e.replyId&&t("cancel-reply")}).catch(P=>{B.value=!1,alert(P.message)})},ce=p=>{v.value.contains(p.target)||b.value.contains(p.target)||(c.value=!1)};return ve(()=>n.editor,p=>{const{highlighter:h,texRenderer:C}=o.value;z.value=p,$.value=Mt(p,{emojiMap:r.value.map,highlighter:h,texRenderer:C}),U.value=(j=>(R=>R.match(/[\w\d\s\u00C0-\u024F]+/giu)||[])(j).reduce((R,y)=>R+(y.trim()===""?0:y.trim().split(/\s+/u).length),0)+(R=>R.match(/[\u4E00-\u9FA5]/gu)||[])(j).length)(p),i.value&&(p?Oe(i.value):Oe.destroy(i.value))},{immediate:!0}),ve(()=>o.value.emoji,p=>p.then(h=>{r.value=h}),{immediate:!0}),ve([o,U],([p,h])=>{const{wordLimit:C}=p;C?h<C[0]&&C[0]!==0?(I.value=C[0],M.value=!1):h>C[1]?(I.value=C[1],M.value=!1):(I.value=C[1],M.value=!0):(I.value=0,M.value=!0)},{immediate:!0}),Ke(()=>{document.body.addEventListener("click",ce)}),mt(()=>{document.body.removeEventListener("click",ce)}),{config:o,locale:N,insert:K,onChange:()=>{const p=l.value;p.files&&_.value&&D(p.files[0]).then(()=>{p.value=""})},onDrop:p=>{var h;if((h=p.dataTransfer)!=null&&h.items){const C=De(p.dataTransfer.items);C&&_.value&&(D(C),p.preventDefault())}},onKeyDown:p=>{const h=p.key;(p.ctrlKey||p.metaKey)&&h==="Enter"&&V()},onPaste:p=>{if(p.clipboardData){const h=De(p.clipboardData.items);h&&_.value&&D(h)}},onLogin:p=>{p.preventDefault();const{lang:h,serverURL:C}=o.value,j=(window.innerWidth-450)/2,R=(window.innerHeight-450)/2,y=window.open(`${C}/ui/login?lng=${encodeURIComponent(h)}`,"_blank",`width=450,height=450,left=${j},top=${R},scrollbars=no,resizable=no,status=no,location=no,toolbar=no,menubar=no`);y==null||y.postMessage({type:"TOKEN",data:null},"*");const O=({data:A})=>{A&&A.type==="userInfo"&&A.data.token&&(y==null||y.close(),m(A.data),(A.data.remember?localStorage:sessionStorage).setItem("WALINE_USER",JSON.stringify(A.data)),window.removeEventListener("message",O))};window.addEventListener("message",O)},onLogout:()=>{m({}),localStorage.setItem("WALINE_USER","null"),sessionStorage.setItem("WALINE_USER","null")},onProfile:p=>{var O;p.preventDefault();const{lang:h,serverURL:C}=o.value,j=(window.innerWidth-800)/2,R=(window.innerHeight-800)/2;(O=window.open(`${C}/ui/profile?lng=${encodeURIComponent(h)}`,"_blank",`width=800,height=800,left=${j},top=${R},scrollbars=no,resizable=no,status=no,location=no,toolbar=no,menubar=no`))==null||O.postMessage({type:"TOKEN",data:s.value.token},"*");const y=({data:A})=>{A&&A.type==="profile"&&(m(Object.assign({},s.value,A)),[localStorage,sessionStorage].filter(q=>q.getItem("WALINE_USER")).forEach(q=>q.setItem("WALINE_USER",JSON.stringify(s))),window.removeEventListener("message",y))};window.addEventListener("message",y)},submitComment:V,isLogin:te,userInfo:s,isSubmitting:B,wordNumber:U,wordLimit:I,isWordNumberLegal:M,inputs:n,emoji:r,emojiTabIndex:k,showEmoji:c,canUploadImage:_,previewText:$,showPreview:f,inputRefs:a,editorRef:i,emojiButtonRef:v,emojiPopupRef:b,imageUploadRef:l}}});const Bt={class:"wl-comment"},Ot={key:0,class:"wl-login-info"},Pt={class:"wl-avatar"},Ft=["title"],Ht=["src"],Wt=["textContent"],_t={class:"wl-panel"},Dt=["for","textContent"],Vt=["id","name","type","onUpdate:modelValue"],qt=["placeholder"],Jt=["innerHTML"],Kt={class:"wl-footer"},Yt={class:"wl-actions"},Xt={href:"https://guides.github.com/features/mastering-markdown/",title:"Markdown Guide","aria-label":"Markdown is supported",class:"wl-action",target:"_blank",rel:"noreferrer"},Gt=["title"],Qt=["title"],Zt=["title"],en={class:"wl-info"},tn={class:"wl-text-number"},nn={key:0},on=G(" \xA0/\xA0 "),rn=["textContent"],an=["textContent"],ln=["disabled"],sn={key:0,class:"wl-tab-wrapper"},cn=["title","onClick"],un=["src","alt"],mn={key:0,class:"wl-tabs"},dn=["onClick"],pn=["src","alt","title"],gn=["title"];fe.render=function(e,t,o,n,u,s){const m=T("CloseIcon"),a=T("MarkdownIcon"),i=T("EmojiIcon"),l=T("ImageIcon"),v=T("PreviewIcon"),b=T("LoadingIcon");return d(),g("div",Bt,[e.config.login!=="disable"&&e.isLogin?(d(),g("div",Ot,[w("div",Pt,[w("button",{class:"wl-logout-btn",title:e.locale.logout,onClick:t[0]||(t[0]=(...r)=>e.onLogout&&e.onLogout(...r))},[F(m,{size:14})],8,Ft),w("img",{src:e.userInfo.avatar,alt:"avatar"},null,8,Ht)]),w("a",{href:"#",class:"wl-login-nick","aria-label":"Profile",onClick:t[1]||(t[1]=(...r)=>e.onProfile&&e.onProfile(...r)),textContent:S(e.userInfo.display_name)},null,8,Wt)])):x("v-if",!0),w("div",_t,[e.config.login!=="force"&&e.config.meta.length&&!e.isLogin?(d(),g("div",{key:0,class:J(["wl-header",`item${e.config.meta.length}`])},[(d(!0),g(H,null,Z(e.config.meta,r=>(d(),g("div",{class:"wl-header-item",key:r},[w("label",{for:r,textContent:S(e.locale[r]+(e.config.requiredMeta.includes(r)||!e.config.requiredMeta.length?"":`(${e.locale.optional})`))},null,8,Dt),Be(w("input",{ref_for:!0,ref:k=>{k&&(e.inputRefs[r]=k)},id:`wl-${r}`,class:J(["wl-input",`wl-${r}`]),name:r,type:r==="mail"?"email":"text","onUpdate:modelValue":k=>e.inputs[r]=k},null,10,Vt),[[dt,e.inputs[r]]])]))),128))],2)):x("v-if",!0),Be(w("textarea",{class:"wl-editor",ref:"editorRef",id:"wl-edit",placeholder:e.replyUser?`@${e.replyUser}`:e.locale.placeholder,"onUpdate:modelValue":t[2]||(t[2]=r=>e.inputs.editor=r),onKeydown:t[3]||(t[3]=(...r)=>e.onKeyDown&&e.onKeyDown(...r)),onDrop:t[4]||(t[4]=(...r)=>e.onDrop&&e.onDrop(...r)),onPaste:t[5]||(t[5]=(...r)=>e.onPaste&&e.onPaste(...r))},null,40,qt),[[pt,e.inputs.editor]]),w("div",{class:"wl-preview",style:gt({display:e.showPreview?"block":"none"})},[w("h4",null,S(e.locale.preview)+":",1),w("div",{class:"wl-content",innerHTML:e.previewText},null,8,Jt)],4),w("div",Kt,[w("div",Yt,[w("a",Xt,[F(a)]),w("button",{ref:"emojiButtonRef",class:J(["wl-action",{actived:e.showEmoji}]),title:e.locale.emoji,onClick:t[6]||(t[6]=r=>e.showEmoji=!e.showEmoji)},[F(i)],10,Gt),w("input",{ref:"imageUploadRef",class:"upload",id:"wl-image-upload",type:"file",accept:".png,.jpg,.jpeg,.webp,.bmp,.gif",onChange:t[7]||(t[7]=(...r)=>e.onChange&&e.onChange(...r))},null,544),e.canUploadImage?(d(),g("label",{key:0,for:"wl-image-upload",class:"wl-action",title:e.locale.uploadImage},[F(l)],8,Qt)):x("v-if",!0),w("button",{class:J(["wl-action",{actived:e.showPreview}]),title:e.locale.preview,onClick:t[8]||(t[8]=r=>e.showPreview=!e.showPreview)},[F(v)],10,Zt)]),w("div",en,[w("div",tn,[G(S(e.wordNumber)+" ",1),e.config.wordLimit?(d(),g("span",nn,[on,w("span",{class:J({illegal:!e.isWordNumberLegal}),textContent:S(e.wordLimit)},null,10,rn)])):x("v-if",!0),G(" \xA0"+S(e.locale.word),1)]),e.config.login==="disable"||e.isLogin?x("v-if",!0):(d(),g("button",{key:0,class:"wl-btn",onClick:t[9]||(t[9]=(...r)=>e.onLogin&&e.onLogin(...r)),textContent:S(e.locale.login)},null,8,an)),e.config.login!=="force"||e.isLogin?(d(),g("button",{key:1,class:"wl-btn primary",title:"Cmd|Ctrl + Enter",disabled:e.isSubmitting,onClick:t[10]||(t[10]=(...r)=>e.submitComment&&e.submitComment(...r))},[e.isSubmitting?(d(),ie(b,{key:0,size:16})):(d(),g(H,{key:1},[G(S(e.locale.submit),1)],2112))],8,ln)):x("v-if",!0)]),w("div",{ref:"emojiPopupRef",class:J(["wl-emoji-popup",{display:e.showEmoji}])},[(d(!0),g(H,null,Z(e.emoji.tabs,(r,k)=>(d(),g(H,{key:r.name},[k===e.emojiTabIndex?(d(),g("div",sn,[(d(!0),g(H,null,Z(r.items,c=>(d(),g("button",{key:c,title:c,onClick:f=>e.insert(`:${c}:`)},[e.showEmoji?(d(),g("img",{key:0,class:"wl-emoji",src:e.emoji.map[c],alt:c,loading:"lazy",referrerPolicy:"no-referrer"},null,8,un)):x("v-if",!0)],8,cn))),128))])):x("v-if",!0)],64))),128)),e.emoji.tabs.length>1?(d(),g("div",mn,[(d(!0),g(H,null,Z(e.emoji.tabs,(r,k)=>(d(),g("button",{key:r.name,class:J(["wl-tab",{active:e.emojiTabIndex===k}]),onClick:c=>e.emojiTabIndex=k},[w("img",{class:"wl-emoji",src:r.icon,alt:r.name,title:r.name,loading:"lazy",referrerPolicy:"no-referrer"},null,8,pn)],10,dn))),128))])):x("v-if",!0)],2)])]),e.replyId?(d(),g("button",{key:1,class:"wl-close",title:e.locale.cancelReply,onClick:t[11]||(t[11]=r=>e.$emit("cancel-reply"))},[F(m,{size:24})],8,gn)):x("v-if",!0)])},fe.__file="src/components/CommentBox.vue";var Re=ze({props:{comment:{type:Object,required:!0},rootId:{type:String,required:!0},reply:{type:Object}},components:{CommentBox:fe,ReplyIcon:()=>L("svg",{viewBox:"0 0 1024 1024",width:"18",height:"18"},L("path",{d:"M1019.2 720C1001.6 625.6 968 566.4 904 497.6c-89.6-89.6-214.4-150.4-347.2-176v-120c0-25.6-8-51.2-25.6-64-33.6-30.4-81.6-30.4-112-4.8L33.6 441.6C12.8 459.2 0 484.8 0 510.4c0 25.6 12.8 51.2 30.4 68.8l385.6 312c17.6 12.8 33.6 17.6 51.2 17.6 12.8 0 25.6-4.8 38.4-8C536 888 552 857.6 552 824v-99.2c124.8 20.8 248 86.4 339.2 140.8 25.6 17.6 59.2 17.6 89.6 0 25.6-17.6 43.2-46.4 43.2-76.8 0-33.6 0-56-4.8-68.8zm-500.8-89.6-46.4-4.8v193.6L86.4 510.4 472 201.6V400l38.4 4.8c128 12.8 248 68.8 334.4 153.6 51.2 56 76.8 102.4 94.4 179.2 0 4.8 4.8 20.8 4.8 51.2C835.2 720 672 640 518.4 630.4z",fill:"currentColor"})),VerifiedIcon:()=>L("svg",{class:"verified-icon",viewBox:"0 0 1024 1024",width:"14",height:"14"},L("path",{d:"m894.4 461.56-54.4-63.2c-10.4-12-18.8-34.4-18.8-50.4v-68c0-42.4-34.8-77.2-77.2-77.2h-68c-15.6 0-38.4-8.4-50.4-18.8l-63.2-54.4c-27.6-23.6-72.8-23.6-100.8 0l-62.8 54.8c-12 10-34.8 18.4-50.4 18.4h-69.2c-42.4 0-77.2 34.8-77.2 77.2v68.4c0 15.6-8.4 38-18.4 50l-54 63.6c-23.2 27.6-23.2 72.4 0 100l54 63.6c10 12 18.4 34.4 18.4 50v68.4c0 42.4 34.8 77.2 77.2 77.2h69.2c15.6 0 38.4 8.4 50.4 18.8l63.2 54.4c27.6 23.6 72.8 23.6 100.8 0l63.2-54.4c12-10.4 34.4-18.8 50.4-18.8h68c42.4 0 77.2-34.8 77.2-77.2v-68c0-15.6 8.4-38.4 18.8-50.4l54.4-63.2c23.2-27.6 23.2-73.2-.4-100.8zm-216-25.2-193.2 193.2a30 30 0 0 1-42.4 0l-96.8-96.8a30.16 30.16 0 0 1 0-42.4c11.6-11.6 30.8-11.6 42.4 0l75.6 75.6 172-172c11.6-11.6 30.8-11.6 42.4 0 11.6 11.6 11.6 30.8 0 42.4z",fill:"#27ae60"}))},emits:["submit","reply"],setup(e){const t=Je("config"),o=W(()=>t.value.locale),n=W(()=>{let{link:s}=e.comment;return s?et(s)?s:`https://${s}`:""}),u=W(()=>{var s;return e.comment.objectId===((s=e.reply)==null?void 0:s.objectId)});return{config:t,locale:o,isReplyingCurrent:u,link:n,timeAgo:Nt}}});const hn=["id"],vn={class:"wl-user","aria-hidden":"true"},fn=["src"],yn={class:"wl-card"},wn={class:"wl-head"},bn=["href"],kn={key:1,class:"wl-nick"},Cn=["textContent"],$n=["textContent"],xn=["textContent"],En=["title"],Ln={class:"wl-meta","aria-hidden":"true"},Sn=["textContent"],In=["textContent"],Rn=["innerHTML"],jn={key:0,class:"wl-reply-wrapper"},zn={key:1,class:"wl-quote"};Re.render=function(e,t,o,n,u,s){const m=T("VerifiedIcon"),a=T("ReplyIcon"),i=T("CommentBox"),l=T("CommentCard",!0);return d(),g("div",{class:"wl-item",id:e.comment.objectId},[w("div",vn,[e.comment.avatar?(d(),g("img",{key:0,src:e.comment.avatar},null,8,fn)):x("v-if",!0),e.comment.type?(d(),ie(m,{key:1})):x("v-if",!0)]),w("div",yn,[w("div",wn,[e.link?(d(),g("a",{key:0,class:"wl-nick",href:e.link,target:"_blank",rel:"nofollow noreferrer"},S(e.comment.nick),9,bn)):(d(),g("span",kn,S(e.comment.nick),1)),e.comment.type==="administrator"?(d(),g("span",{key:2,class:"wl-badge",textContent:S(e.locale.admin)},null,8,Cn)):x("v-if",!0),e.comment.sticky?(d(),g("span",{key:3,class:"wl-badge",textContent:S(e.locale.sticky)},null,8,$n)):x("v-if",!0),w("span",{class:"wl-time",textContent:S(e.timeAgo(e.comment.insertedAt,e.locale))},null,8,xn),w("button",{class:J(["wl-reply",{active:e.isReplyingCurrent}]),title:e.isReplyingCurrent?e.locale.cancelReply:e.locale.reply,onClick:t[0]||(t[0]=v=>e.$emit("reply",e.isReplyingCurrent?null:e.comment))},[F(a)],10,En)]),w("div",Ln,[e.comment.browser?(d(),g("span",{key:0,textContent:S(e.comment.browser)},null,8,Sn)):x("v-if",!0),e.comment.os?(d(),g("span",{key:1,textContent:S(e.comment.os)},null,8,In)):x("v-if",!0)]),w("div",{class:"wl-content",innerHTML:e.comment.comment},null,8,Rn),e.isReplyingCurrent?(d(),g("div",jn,[F(i,{replyId:e.comment.objectId,replyUser:e.comment.nick,rootId:e.rootId,onSubmit:t[1]||(t[1]=v=>e.$emit("submit",v)),onCancelReply:t[2]||(t[2]=v=>e.$emit("reply",null))},null,8,["replyId","replyUser","rootId"])])):x("v-if",!0),e.comment.children?(d(),g("div",zn,[(d(!0),g(H,null,Z(e.comment.children,v=>(d(),ie(l,{key:v.objectId,comment:v,reply:e.reply,rootId:e.rootId,onReply:t[3]||(t[3]=b=>e.$emit("reply",b)),onSubmit:t[4]||(t[4]=b=>e.$emit("submit",b))},null,8,["comment","reply","rootId"]))),128))])):x("v-if",!0)])],8,hn)},Re.__file="src/components/CommentCard.vue";var je=ze({name:"Waline-Root",components:{CommentBox:fe,CommentCard:Re,LoadingIcon:at},props:{serverURL:{type:String,required:!0},path:{type:String,required:!0},meta:{type:Array},requiredMeta:{type:Array},visitor:{type:Boolean},dark:{type:[String,Boolean]},lang:{type:String},locale:{type:Object},pageSize:{type:Number},wordLimit:{type:[Number,Array]},emoji:{type:Array},login:{type:String},highlighter:{type:Function},imageUploader:{type:[Function,!1]},texRender:{type:Function}},setup(e){const t=W(()=>(p=>{var h=p,{serverURL:c,path:f=location.pathname,lang:$="zh-CN",locale:U,emoji:I=["https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/weibo"],meta:M=["nick","mail","link"],requiredMeta:z=[],pageSize:B=10,wordLimit:N,imageUploader:te,highlighter:_,texRenderer:K,copyright:D=!0,login:V="enable"}=h,ce=de(h,["serverURL","path","lang","locale","emoji","meta","requiredMeta","pageSize","wordLimit","imageUploader","highlighter","texRenderer","copyright","login"]);return Y({serverURL:St(c),path:Qe(f),lang:$,locale:Y(Y({},We[$]||We["zh-CN"]),typeof U=="object"?U:{}),emoji:(C=I,Promise.all(C.map(j=>typeof j=="string"?Lt(Ze(j)):Promise.resolve(j))).then(j=>{const R={tabs:[],map:{}};return j.forEach(y=>{const{name:O,folder:A,icon:q,prefix:Q,type:ne,items:P}=y;R.tabs.push({name:O,icon:_e(q,A,Q,ne),items:P.map(ue=>{const oe=`${Q||""}${ue}`;return R.map[oe]=_e(ue,A,Q,ne),oe})})}),R})),wordLimit:Array.isArray(N)?N:!!N&&[0,N],meta:Pe(M),requiredMeta:Pe(z),pageSize:B,login:V,imageUploader:xe(te,Ct),highlighter:xe(_,bt),texRenderer:xe(K,$t),copyright:D},ce);var C})(e)),{userInfo:o}=Ae(),n=E("loading"),u=E(0),s=E(1),m=E(0),a=E([]),i=E(null),l=W(()=>{return typeof(c=t.value.dark)=="string"?c==="auto"?`@media(prefers-color-scheme:dark){body${Ee}}`:`${c}${Ee}`:c===!0?`:root${Ee}`:"";var c});let v,b;const r=c=>{var M;const{serverURL:f,path:$,pageSize:U}=t.value,I=new AbortController;n.value="loading",v==null||v(),(({serverURL:z,path:B,page:N,pageSize:te,signal:_,token:K})=>{const D={};return K&&(D.Authorization=`Bearer ${K}`),fetch(`${z}/comment?path=${encodeURIComponent(B)}&pageSize=${te}&page=${N}`,{signal:_,headers:D}).then(V=>V.json()).then(V=>se(V,"comment list"))})({serverURL:f,path:$,pageSize:U,page:c,signal:I.signal,token:(M=o.value)==null?void 0:M.token}).then(z=>{n.value="success",u.value=z.count,a.value.push(...z.data),s.value=c,m.value=z.totalPages}).catch(z=>{z.name!=="AbortError"&&(console.error(z.message),n.value="error")}),v=I.abort.bind(I)},k=()=>{u.value=0,a.value=[],r(1)};return ft("config",t),ve(()=>e.path,k),Ke(()=>{var f;k();const c=document.createElement("style");c.innerText=l.value,(f=document.querySelector("[data-waline]"))==null||f.appendChild(c),b=Ie(()=>{c.innerText=l.value})}),ht(()=>b()),{config:t,darkmodeStyle:l,i18n:W(()=>t.value.locale),status:n,count:u,page:s,totalPages:m,data:a,reply:i,loadMore:()=>r(s.value+1),refresh:k,onReply:c=>{i.value=c},onSubmit:c=>{if(c.rid){const f=a.value.find(({objectId:$})=>$===c.rid);if(!f)return;Array.isArray(f.children)||(f.children=[]),f.children.push(c)}else a.value.unshift(c)},version:"2.0.0-alpha.1"}}});const An={"data-waline":""},Un={class:"wl-count"},Mn=["textContent"],Nn={key:1,class:"wl-action"},Tn=["textContent"],Bn={key:2,class:"wl-loading"},On=["textContent"],Pn={key:1,class:"wl-cards"},Fn={key:2,class:"wl-more"},Hn=["textContent"],Wn={key:4,class:"wl-power"},_n=G(" Powered by "),Dn=w("a",{href:"https://github.com/walinejs/waline",target:"_blank",rel:"noreferrer"}," Waline ",-1);je.render=function(e,t,o,n,u,s){const m=T("CommentBox"),a=T("LoadingIcon"),i=T("CommentCard");return d(),g("div",An,[e.reply?x("v-if",!0):(d(),ie(m,{key:0,onSubmit:e.onSubmit},null,8,["onSubmit"])),w("div",Un,[e.count?(d(),g("span",{key:0,class:"wl-num",textContent:S(e.count)},null,8,Mn)):x("v-if",!0),G(" "+S(e.i18n.comment),1)]),e.status==="error"?(d(),g("div",Nn,[w("button",{type:"button",class:"wl-btn",onClick:t[0]||(t[0]=(...l)=>e.refresh&&e.refresh(...l)),textContent:S(e.i18n.refresh)},null,8,Tn)])):e.status==="loading"?(d(),g("div",Bn,[F(a,{size:30})])):(d(),g(H,{key:3},[e.data.length?(d(),g("div",Pn,[(d(!0),g(H,null,Z(e.data,l=>(d(),ie(i,{key:l.objectId,"root-id":l.objectId,comment:l,reply:e.reply,onReply:e.onReply,onSubmit:e.onSubmit},null,8,["root-id","comment","reply","onReply","onSubmit"]))),128))])):(d(),g("div",{key:0,class:"wl-empty",textContent:S(e.i18n.sofa)},null,8,On)),x(" Load more button "),e.page<e.totalPages?(d(),g("div",Fn,[w("button",{type:"button",class:"wl-btn",onClick:t[1]||(t[1]=(...l)=>e.loadMore&&e.loadMore(...l)),textContent:S(e.i18n.more)},null,8,Hn)])):x("v-if",!0)],64)),x(" Copyright Information "),e.config.copyright?(d(),g("div",Wn,[_n,Dn,G(" v"+S(e.version),1)])):x("v-if",!0)])},je.__file="src/components/Waline.vue";const qe=(e,t)=>{t.forEach((o,n)=>{o.innerText=e[n].toString()})},Vn=({serverURL:e,path:t=window.location.pathname,selector:o=".waline-pageview-count",update:n=!0})=>{const u=new AbortController,s=Array.from(document.querySelectorAll(o)),m=i=>{const l=Ve(i);return l!==null&&t!==l},a=i=>Rt({serverURL:e,paths:i.map(l=>Ve(l)||t),signal:u.signal}).then(l=>qe(l,i)).catch(tt);if(n){const i=s.filter(v=>!m(v)),l=s.filter(m);jt({serverURL:e,path:t}).then(v=>qe(new Array(i.length).fill(v),i)),l.length&&a(l)}else a(s);return u.abort.bind(u)},Yn=s=>{var m=s,{el:e="#waline",path:t=window.location.pathname,comment:o=!1,pageview:n=!1}=m,u=de(m,["el","path","comment","pageview"]);const a=e?nt(e):null;if(e&&!a)throw new Error("Option 'el' do not match any domElement!");if(!u.serverURL)throw new Error("Option 'serverURL' is missing!");const i=Se(Y({},u)),l=Se({comment:o,pageview:n,path:t}),v=()=>{l.comment&&Tt({serverURL:i.serverURL,path:l.path,selector:typeof l.comment=="string"?l.comment:void 0})},b=()=>{l.pageview&&Vn({serverURL:i.serverURL,path:l.path,selector:typeof l.pageview=="string"?l.pageview:void 0})},r=a?vt(()=>L(je,Y({path:l.path},i))):null;r&&r.mount(a),v(),b();const k=Ie(v),c=Ie(b);return{el:a,update:M=>{var z=M,{comment:f,pageview:$,path:U=window.location.pathname}=z,I=de(z,["comment","pageview","path"]);Object.entries(I).map(([B,N])=>{i[B]=N}),l.path=U,f!==void 0&&(l.comment=f),$!==void 0&&(l.pageview=$)},destroy:()=>{r==null||r.unmount(),k(),c()}}},Xn="2.0.0-alpha.1",Gn=({el:e,serverURL:t,count:o})=>{var s;const n=nt(e),u=new AbortController;return(({serverURL:m,count:a,signal:i,token:l})=>{const v={};return l&&(v.Authorization=`Bearer ${l}`),fetch(`${m}/comment?type=recent&count=${a}`,{signal:i,headers:v}).then(b=>b.json()).then(b=>se(b,"recent comment"))})({serverURL:t,count:o,signal:u.signal,token:(s=rt())==null?void 0:s.token}).then(m=>n&&m.length?(n.innerHTML=`<ul class="wl-recent-list">${m.map(a=>`<li class="wl-recent-item"><a href="${a.url}">${a.nick}</a>\uFF1A${a.comment}</li>`).join("")}</ul>`,{comments:m,destroy:()=>{u.abort(),n.innerHTML=""}}):{comments:m,destroy:()=>u.abort()})};export{Gn as RecentComments,Tt as commentCount,Kn as defaultLang,$t as defaultTexRenderer,Ct as defaultUploadImage,Pe as getMeta,Yn as init,We as locales,Vn as pageviewCount,Xn as version};
