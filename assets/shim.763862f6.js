var Oe=Object.defineProperty;var Y=Object.getOwnPropertySymbols;var ve=Object.prototype.hasOwnProperty,fe=Object.prototype.propertyIsEnumerable;var he=(t,n,o)=>n in t?Oe(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o,D=(t,n)=>{for(var o in n||(n={}))ve.call(n,o)&&he(t,o,n[o]);if(Y)for(var o of Y(n))fe.call(n,o)&&he(t,o,n[o]);return t};var G=(t,n)=>{var o={};for(var r in t)ve.call(t,r)&&n.indexOf(r)<0&&(o[r]=t[r]);if(t!=null&&Y)for(var r of Y(t))n.indexOf(r)<0&&fe.call(t,r)&&(o[r]=t[r]);return o};var _e=(t,n)=>()=>(n||t((n={exports:{}}).exports,n),n.exports);var pn=_e(I=>{Object.defineProperty(I,"__esModule",{value:!0});var e=require("vue"),qe=require("autosize"),ee=require("marked"),He=require("hanabi");function Le(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var ye=Le(qe),We=Le(He);const Fe=["nick","mail","link"],se=t=>t.filter(n=>Fe.includes(n)),Ie=t=>new Promise((n,o)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>{var d;return n(((d=r.result)==null?void 0:d.toString())||"")},r.onerror=o}),Ve=t=>t===!0?'<p class="vtex">Tex is not available in preview</p>':'<span class="vtex">Tex is not available in preview</span>',Je=["nick","nickError","mail","mailError","link","optional","placeholder","sofa","submit","reply","cancelReply","comment","refresh","more","preview","emoji","uploadImage","seconds","minutes","hours","days","now","uploading","login","logout","admin","sticky","word","wordHint","anonymous"],O=t=>Object.fromEntries(t.map((n,o)=>[Je[o],n]));var te=O(["NickName","NickName cannot be less than 3 bytes.","E-Mail","Please confirm your email address.","Website","Optional","Comment here...","No comment yet.","Submit","Reply","Cancel reply","Comments","Refresh","Load More...","Preview","Emoji","Upload Image","seconds ago","minutes ago","hours ago","days ago","just now","Uploading","Login","logout","Admin","Sticky","Words",`Please input comments between $0 and $1 words!
 Current word number: $2`,"Anonymous"]),ne=O(["\u30CB\u30C3\u30AF\u30CD\u30FC\u30E0","3\u30D0\u30A4\u30C8\u4EE5\u4E0A\u306E\u30CB\u30C3\u30AF\u30CD\u30FC\u30E0\u3092\u3054\u5165\u529B\u304F\u3060\u3055\u3044.","\u30E1\u30FC\u30EB\u30A2\u30C9\u30EC\u30B9","\u30E1\u30FC\u30EB\u30A2\u30C9\u30EC\u30B9\u3092\u3054\u78BA\u8A8D\u304F\u3060\u3055\u3044.","\u30B5\u30A4\u30C8","\u30AA\u30D7\u30B7\u30E7\u30F3","\u3053\u3053\u306B\u30B3\u30E1\u30F3\u30C8","\u30B3\u30E1\u30F3\u30C8\u3057\u307E\u3057\u3087\u3046~","\u63D0\u51FA\u3059\u308B","\u8FD4\u4FE1\u3059\u308B","\u30AD\u30E3\u30F3\u30BB\u30EB","\u30B3\u30E1\u30F3\u30C8","\u66F4\u65B0","\u3055\u3089\u306B\u8AAD\u307F\u8FBC\u3080","\u30D7\u30EC\u30D3\u30E5\u30FC","\u7D75\u6587\u5B57","\u753B\u50CF\u3092\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9","\u79D2\u524D","\u5206\u524D","\u6642\u9593\u524D","\u65E5\u524D","\u305F\u3063\u3060\u4ECA","\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9","\u30ED\u30B0\u30A4\u30F3\u3059\u308B","\u30ED\u30B0\u30A2\u30A6\u30C8","\u7BA1\u7406\u8005","\u30C8\u30C3\u30D7\u306B\u7F6E\u304F","\u30EF\u30FC\u30C9",`\u30B3\u30E1\u30F3\u30C8\u306F $0 \u304B\u3089 $1 \u30EF\u30FC\u30C9\u306E\u9593\u3067\u306A\u3051\u308C\u3070\u306A\u308A\u307E\u305B\u3093!
 \u73FE\u5728\u306E\u5358\u8A9E\u756A\u53F7: $2`,"\u533F\u540D"]),oe=O(["\u6635\u79F0","\u6635\u79F0\u4E0D\u80FD\u5C11\u4E8E3\u4E2A\u5B57\u7B26","\u90AE\u7BB1","\u8BF7\u586B\u5199\u6B63\u786E\u7684\u90AE\u4EF6\u5730\u5740","\u7F51\u5740","\u53EF\u9009","\u6B22\u8FCE\u8BC4\u8BBA","\u6765\u53D1\u8BC4\u8BBA\u5427~","\u63D0\u4EA4","\u56DE\u590D","\u53D6\u6D88\u56DE\u590D","\u8BC4\u8BBA","\u5237\u65B0","\u52A0\u8F7D\u66F4\u591A...","\u9884\u89C8","\u8868\u60C5","\u4E0A\u4F20\u56FE\u7247","\u79D2\u524D","\u5206\u949F\u524D","\u5C0F\u65F6\u524D","\u5929\u524D","\u521A\u521A","\u6B63\u5728\u4E0A\u4F20","\u767B\u5F55","\u9000\u51FA","\u535A\u4E3B","\u7F6E\u9876","\u5B57",`\u8BC4\u8BBA\u5B57\u6570\u5E94\u5728 $0 \u5230 $1 \u5B57\u4E4B\u95F4\uFF01
\u5F53\u524D\u5B57\u6570\uFF1A$2`,"\u533F\u540D"]),ke=O(["\u66B1\u7A31","\u90F5\u7BB1","\u7DB2\u5740","\u53EF\u9078","\u66B1\u7A31\u4E0D\u80FD\u5C11\u65BC3\u500B\u5B57\u5143","\u8ACB\u586B\u5BEB\u6B63\u78BA\u7684\u90F5\u4EF6\u5730\u5740","\u6B61\u8FCE\u8A55\u8AD6","\u4F86\u767C\u8A55\u8AD6\u5427~","\u63D0\u4EA4","\u56DE\u8986","\u53D6\u6D88\u56DE\u8986","\u8A55\u8AD6","\u5237\u65B0","\u8F09\u5165\u66F4\u591A...","\u9810\u89BD","\u8868\u60C5","\u4E0A\u50B3\u5716\u7247","\u79D2\u524D","\u5206\u9418\u524D","\u5C0F\u6642\u524D","\u5929\u524D","\u525B\u525B","\u6B63\u5728\u4E0A\u50B3","\u767B\u9304","\u9000\u51FA","\u535A\u4E3B","\u7F6E\u9802","\u5B57",`\u8A55\u8AD6\u5B57\u6578\u61C9\u5728 $0 \u5230 $1 \u5B57\u4E4B\u9593\uFF01
\u7576\u524D\u5B57\u6578\uFF1A$2`,"\u533F\u540D"]),we=O(["Apelido","Apelido n\xE3o pode ser menor que 3 bytes.","E-Mail","Por favor, confirme seu endere\xE7o de e-mail.","Website","Opcional","Comente aqui...","Nenhum coment\xE1rio, ainda.","Enviar","Responder","Cancelar resposta","Coment\xE1rios","Refrescar","Carregar Mais...","Visualizar","Emoji","Enviar Imagem","segundos atr\xE1s","minutos atr\xE1s","horas atr\xE1s","dias atr\xE1s","agora mesmo","Enviando","Entrar","Sair","Admin","Sticky","Palavras",`Favor enviar coment\xE1rio com $0 a $1 palavras!
 N\xFAmero de palavras atuais: $2`,"An\xF4nimo"]),re=O(["\u041F\u0441\u0435\u0432\u0434\u043E\u043D\u0438\u043C","\u041D\u0438\u043A\u043D\u0435\u0439\u043C \u043D\u0435 \u043C\u043E\u0436\u0435\u0442 \u0431\u044B\u0442\u044C \u043C\u0435\u043D\u044C\u0448\u0435 3 \u0431\u0430\u0439\u0442.","\u042D\u043B. \u0430\u0434\u0440\u0435\u0441","\u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u0430\u0434\u0440\u0435\u0441 \u0432\u0430\u0448\u0435\u0439 \u044D\u043B\u0435\u043A\u0442\u0440\u043E\u043D\u043D\u043E\u0439 \u043F\u043E\u0447\u0442\u044B.","\u0412\u0435\u0431-\u0441\u0430\u0439\u0442","\u041D\u0435\u043E\u0431\u044F\u0437\u0430\u0442\u0435\u043B\u044C\u043D\u044B\u0439","\u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439 \u0437\u0434\u0435\u0441\u044C...","\u041F\u043E\u043A\u0430 \u043D\u0435\u0442 \u043A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0435\u0432.","\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C","\u041E\u0442\u0432\u0435\u0447\u0430\u0442\u044C","\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C \u043E\u0442\u0432\u0435\u0442","\u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0438","\u041E\u0431\u043D\u043E\u0432\u0438\u0442\u044C","\u0417\u0430\u0433\u0440\u0443\u0437\u0438 \u0431\u043E\u043B\u044C\u0448\u0435...","\u041F\u0440\u0435\u0432\u044C\u044E","\u044D\u043C\u043E\u0434\u0437\u0438","\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435","\u0441\u0435\u043A\u0443\u043D\u0434 \u043D\u0430\u0437\u0430\u0434","\u043D\u0435\u0441\u043A\u043E\u043B\u044C\u043A\u043E \u043C\u0438\u043D\u0443\u0442 \u043D\u0430\u0437\u0430\u0434","\u043D\u0435\u0441\u043A\u043E\u043B\u044C\u043A\u043E \u0447\u0430\u0441\u043E\u0432 \u043D\u0430\u0437\u0430\u0434","\u0434\u043D\u0435\u0439 \u043D\u0430\u0437\u0430\u0434","\u043F\u0440\u044F\u043C\u043E \u0441\u0435\u0439\u0447\u0430\u0441","\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430","\u0410\u0432\u0442\u043E\u0440\u0438\u0437\u043E\u0432\u0430\u0442\u044C\u0441\u044F","\u0412\u044B\u0445\u043E\u0434 \u0438\u0437 \u0441\u0438\u0441\u0442\u0435\u043C\u044B","\u0410\u0434\u043C\u0438\u043D","\u041B\u0438\u043F\u043A\u0438\u0439","\u0421\u043B\u043E\u0432\u0430",`\u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0438 \u043E\u0442 $0 \u0434\u043E $1 \u0441\u043B\u043E\u0432!
\u041D\u043E\u043C\u0435\u0440 \u0442\u0435\u043A\u0443\u0449\u0435\u0433\u043E \u0441\u043B\u043E\u0432\u0430: $2`,"\u0410\u043D\u043E\u043D\u0438\u043C\u043D\u044B\u0439"]);const me={zh:oe,"zh-cn":oe,"zh-CN":oe,"zh-tw":ke,"zh-TW":ke,en:te,"en-US":te,"en-us":te,jp:ne,"jp-jp":ne,"jp-JP":ne,"pt-br":we,"pt-BR":we,ru:re,"ru-ru":re,"ru-RU":re},Re=t=>{let n={};const o=localStorage.getItem(t);if(o)try{n=JSON.parse(o)}catch{}return{get:r=>n[r]||null,set(r,d){try{n[r]=JSON.parse(JSON.stringify(d)),localStorage.setItem(t,JSON.stringify(n))}catch{}},update(r){n=JSON.parse(JSON.stringify(r)),localStorage.setItem(t,JSON.stringify(n))}}};let W,le;const Ke=()=>(le||(W=Re("WALINE_USER_CACHE"),le=e.reactive({nick:W.get("nick")||"",mail:W.get("mail")||"",link:W.get("link")||"",editor:""})),{inputs:le,store:W}),xe=t=>{try{t=decodeURI(t)}catch{}return t},je=(t="")=>t.replace(/\/$/u,""),Ue=t=>/^(https?:)?\/\//.test(t);let Q;const Ye=t=>{Q||(Q=Re("WALINE_EMOJI"));const n=Boolean(/@[0-9]+\.[0-9]+\.[0-9]+/.test(t));if(n){const o=Q.get(t);if(o)return Promise.resolve(o)}return fetch(`${t}/info.json`).then(o=>o.json()).then(o=>{const r=D({folder:t},o);return n&&Q.set(t,r),r})},Ce=(t,n,o="",r="")=>`${n}/${o}${t}${r?`.${r}`:""}`,Ge=t=>{const n=je(t);return Ue(n)?n:`https://${n}`},ae=(t,n)=>typeof t=="function"?t:t!==!1&&n,ie="{--waline-white:#000;--waline-light-grey:#666;--waline-dark-grey:#999;--waline-color:#888;--waline-bgcolor:#1e1e1e;--waline-bgcolor-light:#272727;--waline-bgcolor-hover: #444;--waline-border-color:#333;--waline-disable-bgcolor:#444;--waline-disable-color:#272727;--waline-bq-color:#272727;--waline-info-bgcolor:#272727;--waline-info-color:#666}",Qe=t=>t.type.includes("image"),be=t=>{const n=Array.from(t).find(Qe);return n?n.getAsFile():null},ze=t=>{t.name!=="AbortError"&&console.error(t.message)},F=(t,n="")=>{if(typeof t=="object"&&t.errno)throw new TypeError(`Fetch ${n} failed with ${t.errno}: ${t.errmsg}`);return t},Xe=({serverURL:t,paths:n,signal:o})=>fetch(`${t}/article?path=${encodeURIComponent(n.join(","))}`,{signal:o}).then(r=>r.json()).then(r=>F(r,"visit count")).then(r=>Array.isArray(r)?r:[r]),Ze=({serverURL:t,path:n})=>fetch(`${t}/article`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:n})}).then(o=>o.json()).then(o=>F(o,"visit count")),Ee=t=>t instanceof HTMLElement?t:typeof t=="string"?document.querySelector(t):null,et=/\$.*?\$/,tt=/^\$(.*?)\$/,nt=/^(?:\s{0,3})\$\$((?:[^\n]|\n[^\n])+?)\n{0,1}\$\$/,Ae=(t="",n={})=>t.replace(/:(.+?):/g,(o,r)=>n[r]?`<img class="vemoji" src="${n[r]}" alt="${r}">`:o),ot=(t,{emojiMap:n,highlighter:o,texRenderer:r})=>{if(ee.marked.setOptions({highlight:o||void 0,breaks:!0,smartLists:!0,smartypants:!0}),r){const d=(c=>[{name:"blockMath",level:"block",tokenizer(m){const a=nt.exec(m);if(a!==null)return{type:"html",raw:a[0],text:c(!0,a[1])}}},{name:"inlineMath",level:"inline",start(m){const a=m.search(et);return a!==-1?a:m.length},tokenizer(m){const a=tt.exec(m);if(a!==null)return{type:"html",raw:a[0],text:c(!1,a[1])}}}])(r);ee.marked.use({extensions:d})}return ee.marked.parse(Ae(t,n))},Be=t=>t.dataset.path||t.getAttribute("id"),ce=(t,n)=>{let o=t.toString();for(;o.length<n;)o="0"+o;return o},rt=(t,n)=>{if(t)try{typeof t=="string"&&(t=new Date(t.indexOf(" ")!==-1?t.replace(/-/g,"/"):t));const o=t.getTime(),r=new Date().getTime()-o,d=Math.floor(r/864e5);if(d===0){const c=r%864e5,m=Math.floor(c/36e5);if(m===0){const a=c%36e5,u=Math.floor(a/6e4);if(u===0){const i=a%6e4;return`${Math.round(i/1e3)} ${n.seconds}`}return`${u} ${n.minutes}`}return`${m} ${n.hours}`}return d<0?n.now:d<8?`${d} ${n.days}`:(c=>{const m=ce(c.getDate(),2),a=ce(c.getMonth()+1,2);return`${ce(c.getFullYear(),2)}-${a}-${m}`})(t)}catch(o){console.log(o)}return""},Me=()=>{try{const t=localStorage.getItem("WALINE_USER"),n=sessionStorage.getItem("WALINE_USER");return t?JSON.parse(t):n?JSON.parse(n):null}catch{return null}},X=e.ref({}),pe=()=>{if(!X.value.token){const t=Me();t&&(X.value=t)}return{userInfo:e.readonly(X),setUserInfo:t=>{X.value=t}}},Ne=({serverURL:t,path:n=window.location.pathname,selector:o=".waline-comment-count"})=>{var m;const r=new AbortController,d=document.querySelectorAll(o),{userInfo:c}=pe();return d.length&&(({serverURL:a,paths:u,signal:i,token:v})=>{const y={};return v&&(y.Authorization=`Bearer ${v}`),fetch(`${a}/comment?type=count&url=${encodeURIComponent(u.join(","))}`,{signal:i,headers:y}).then(l=>l.json()).then(l=>F(l,"comment count")).then(l=>Array.isArray(l)?l:[l])})({serverURL:t,paths:Array.from(d).map(a=>xe(a.dataset.path||a.getAttribute("id")||n)),signal:r.signal,token:(m=c.value)==null?void 0:m.token}).then(a=>{d.forEach((u,i)=>{u.innerText=a[i].toString()})}).catch(ze),r.abort.bind(r)},Te=({size:t})=>e.h("svg",{width:t,height:t,viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid"},e.h("circle",{cx:50,cy:50,fill:"none",stroke:"currentColor",strokeWidth:"4",r:"40","stroke-dasharray":"85 30"},e.h("animateTransform",{attributeName:"transform",type:"rotate",repeatCount:"indefinite",dur:"1s",values:"0 50 50;360 50 50",keyTimes:"0;1"})));var Z=e.defineComponent({name:"CommentBox",components:{CloseIcon:({size:t})=>e.h("svg",{class:"vclose-icon",viewBox:"0 0 1024 1024",width:t,height:t},[e.h("path",{d:"M697.173 85.333h-369.92c-144.64 0-241.92 101.547-241.92 252.587v348.587c0 150.613 97.28 252.16 241.92 252.16h369.92c144.64 0 241.494-101.547 241.494-252.16V337.92c0-151.04-96.854-252.587-241.494-252.587z",fill:"currentColor"}),e.h("path",{d:"m640.683 587.52-75.947-75.861 75.904-75.862a37.29 37.29 0 0 0 0-52.778 37.205 37.205 0 0 0-52.779 0l-75.946 75.818-75.862-75.946a37.419 37.419 0 0 0-52.821 0 37.419 37.419 0 0 0 0 52.821l75.947 75.947-75.776 75.733a37.29 37.29 0 1 0 52.778 52.821l75.776-75.776 75.947 75.947a37.376 37.376 0 0 0 52.779-52.821z",fill:"#888"})]),EmojiIcon:()=>e.h("svg",{viewBox:"0 0 1024 1024",width:"24",height:"24"},e.h("path",{d:"M563.2 463.3 677 540c1.7 1.2 3.7 1.8 5.8 1.8.7 0 1.4-.1 2-.2 2.7-.5 5.1-2.1 6.6-4.4l25.3-37.8c1.5-2.3 2.1-5.1 1.6-7.8s-2.1-5.1-4.4-6.6l-73.6-49.1 73.6-49.1c2.3-1.5 3.9-3.9 4.4-6.6.5-2.7 0-5.5-1.6-7.8l-25.3-37.8a10.1 10.1 0 0 0-6.6-4.4c-.7-.1-1.3-.2-2-.2-2.1 0-4.1.6-5.8 1.8l-113.8 76.6c-9.2 6.2-14.7 16.4-14.7 27.5.1 11 5.5 21.3 14.7 27.4zM387 348.8h-45.5c-5.7 0-10.4 4.7-10.4 10.4v153.3c0 5.7 4.7 10.4 10.4 10.4H387c5.7 0 10.4-4.7 10.4-10.4V359.2c0-5.7-4.7-10.4-10.4-10.4zm333.8 241.3-41-20a10.3 10.3 0 0 0-8.1-.5c-2.6.9-4.8 2.9-5.9 5.4-30.1 64.9-93.1 109.1-164.4 115.2-5.7.5-9.9 5.5-9.5 11.2l3.9 45.5c.5 5.3 5 9.5 10.3 9.5h.9c94.8-8 178.5-66.5 218.6-152.7 2.4-5 .3-11.2-4.8-13.6zm186-186.1c-11.9-42-30.5-81.4-55.2-117.1-24.1-34.9-53.5-65.6-87.5-91.2-33.9-25.6-71.5-45.5-111.6-59.2-41.2-14-84.1-21.1-127.8-21.1h-1.2c-75.4 0-148.8 21.4-212.5 61.7-63.7 40.3-114.3 97.6-146.5 165.8-32.2 68.1-44.3 143.6-35.1 218.4 9.3 74.8 39.4 145 87.3 203.3.1.2.3.3.4.5l36.2 38.4c1.1 1.2 2.5 2.1 3.9 2.6 73.3 66.7 168.2 103.5 267.5 103.5 73.3 0 145.2-20.3 207.7-58.7 37.3-22.9 70.3-51.5 98.1-85 27.1-32.7 48.7-69.5 64.2-109.1 15.5-39.7 24.4-81.3 26.6-123.8 2.4-43.6-2.5-87-14.5-129zm-60.5 181.1c-8.3 37-22.8 72-43 104-19.7 31.1-44.3 58.6-73.1 81.7-28.8 23.1-61 41-95.7 53.4-35.6 12.7-72.9 19.1-110.9 19.1-82.6 0-161.7-30.6-222.8-86.2l-34.1-35.8c-23.9-29.3-42.4-62.2-55.1-97.7-12.4-34.7-18.8-71-19.2-107.9-.4-36.9 5.4-73.3 17.1-108.2 12-35.8 30-69.2 53.4-99.1 31.7-40.4 71.1-72 117.2-94.1 44.5-21.3 94-32.6 143.4-32.6 49.3 0 97 10.8 141.8 32 34.3 16.3 65.3 38.1 92 64.8 26.1 26 47.5 56 63.6 89.2 16.2 33.2 26.6 68.5 31 105.1 4.6 37.5 2.7 75.3-5.6 112.3z",fill:"currentColor"})),ImageIcon:()=>e.h("svg",{viewBox:"0 0 1024 1024",width:"24",height:"24"},[e.h("path",{d:"M784 112H240c-88 0-160 72-160 160v480c0 88 72 160 160 160h544c88 0 160-72 160-160V272c0-88-72-160-160-160zm96 640c0 52.8-43.2 96-96 96H240c-52.8 0-96-43.2-96-96V272c0-52.8 43.2-96 96-96h544c52.8 0 96 43.2 96 96v480z",fill:"currentColor"}),e.h("path",{d:"M352 480c52.8 0 96-43.2 96-96s-43.2-96-96-96-96 43.2-96 96 43.2 96 96 96zm0-128c17.6 0 32 14.4 32 32s-14.4 32-32 32-32-14.4-32-32 14.4-32 32-32zm462.4 379.2-3.2-3.2-177.6-177.6c-25.6-25.6-65.6-25.6-91.2 0l-80 80-36.8-36.8c-25.6-25.6-65.6-25.6-91.2 0L200 728c-4.8 6.4-8 14.4-8 24 0 17.6 14.4 32 32 32 9.6 0 16-3.2 22.4-9.6L380.8 640l134.4 134.4c6.4 6.4 14.4 9.6 24 9.6 17.6 0 32-14.4 32-32 0-9.6-4.8-17.6-9.6-24l-52.8-52.8 80-80L769.6 776c6.4 4.8 12.8 8 20.8 8 17.6 0 32-14.4 32-32 0-8-3.2-16-8-20.8z",fill:"currentColor"})]),MarkdownIcon:()=>e.h("svg",{width:"16",height:"16",ariaHidden:"true"},e.h("path",{d:"M14.85 3H1.15C.52 3 0 3.52 0 4.15v7.69C0 12.48.52 13 1.15 13h13.69c.64 0 1.15-.52 1.15-1.15v-7.7C16 3.52 15.48 3 14.85 3zM9 11H7V8L5.5 9.92 4 8v3H2V5h2l1.5 2L7 5h2v6zm2.99.5L9.5 8H11V5h2v3h1.5l-2.51 3.5z",fill:"currentColor"})),PreviewIcon:()=>e.h("svg",{viewBox:"0 0 1024 1024",width:"24",height:"24"},[e.h("path",{d:"M710.816 654.301c70.323-96.639 61.084-230.578-23.705-314.843-46.098-46.098-107.183-71.109-172.28-71.109-65.008 0-126.092 25.444-172.28 71.109-45.227 46.098-70.756 107.183-70.756 172.106 0 64.923 25.444 126.007 71.194 172.106 46.099 46.098 107.184 71.109 172.28 71.109 51.414 0 100.648-16.212 142.824-47.404l126.53 126.006c7.058 7.06 16.297 10.979 26.406 10.979 10.105 0 19.343-3.919 26.402-10.979 14.467-14.467 14.467-38.172 0-52.723L710.816 654.301zm-315.107-23.265c-65.88-65.88-65.88-172.54 0-238.42 32.069-32.07 74.245-49.149 119.471-49.149 45.227 0 87.407 17.603 119.472 49.149 65.88 65.879 65.88 172.539 0 238.42-63.612 63.178-175.242 63.178-238.943 0zm0 0",fill:"currentColor"}),e.h("path",{d:"M703.319 121.603H321.03c-109.8 0-199.469 89.146-199.469 199.38v382.034c0 109.796 89.236 199.38 199.469 199.38h207.397c20.653 0 37.384-16.645 37.384-37.299 0-20.649-16.731-37.296-37.384-37.296H321.03c-68.582 0-124.352-55.77-124.352-124.267V321.421c0-68.496 55.77-124.267 124.352-124.267h382.289c68.582 0 124.352 55.771 124.352 124.267V524.72c0 20.654 16.736 37.299 37.385 37.299 20.654 0 37.384-16.645 37.384-37.299V320.549c-.085-109.8-89.321-198.946-199.121-198.946zm0 0",fill:"currentColor"})]),LoadingIcon:Te},props:{rootId:{type:String,default:""},replyId:{type:String,default:""},replyUser:{type:String,default:""}},emits:["submit","cancel-reply"],setup(t,{emit:n}){const o=e.inject("config"),{inputs:r,store:d}=Ke(),{userInfo:c,setUserInfo:m}=pe(),a=e.ref({}),u=e.ref(null),i=e.ref(null),v=e.ref(null),y=e.ref(null),l=e.ref({tabs:[],map:{}}),w=e.ref(0),h=e.ref(!1),C=e.ref(!1),$=e.ref(""),V=e.ref(0),S=e.ref(0),L=e.ref(!1),E=e.ref(""),R=e.ref(!1),N=e.computed(()=>o.value.locale),_=e.computed(()=>{var s;return Boolean((s=c.value)==null?void 0:s.token)}),U=e.computed(()=>o.value.imageUploader!==!1),T=s=>{const p=u.value,f=p.selectionStart,b=p.selectionEnd||0,k=p.scrollTop;r.editor=p.value.substring(0,f)+s+p.value.substring(b,p.value.length),p.focus(),p.selectionStart=f+s.length,p.selectionEnd=f+s.length,p.scrollTop=k},z=s=>{const p=`![${o.value.locale.uploading} ${s.name}]()`;return T(p),Promise.resolve().then(()=>o.value.imageUploader(s)).then(f=>{r.editor=r.editor.replace(p,`\r
![${s.name}](${f})`)})},A=()=>{var x,B,M,P,q;const{serverURL:s,lang:p,login:f,wordLimit:b,requiredMeta:k}=o.value,g={comment:E.value,nick:r.nick,mail:r.mail,link:r.link,ua:navigator.userAgent,url:o.value.path};if((x=c.value)!=null&&x.token)g.nick=c.value.display_name,g.mail=c.value.email,g.link=c.value.url;else{if(f==="force")return;if((k.indexOf("nick")>-1||g.nick)&&!g.nick)return(B=a.value.nick)==null||B.focus(),alert(N.value.nickError);if(k.indexOf("mail")>-1&&!g.mail)return(M=a.value.mail)==null||M.focus(),alert(N.value.mailError);if(!g.comment)return void((P=u.value)==null?void 0:P.focus());g.nick||(g.nick=N.value.anonymous)}if(!L.value)return alert(N.value.wordHint.replace("$0",b[0].toString()).replace("$1",b[1].toString()).replace("$2",V.value.toString()));g.comment=Ae(g.comment,l.value.map),t.replyId&&t.rootId&&(g.pid=t.replyId,g.rid=t.rootId,g.at=t.replyUser),R.value=!0,(({serverURL:j,lang:K,token:H,comment:De})=>{const ge={"Content-Type":"application/json"};return H&&(ge.Authorization=`Bearer ${H}`),fetch(`${j}/comment?lang=${K}`,{method:"POST",headers:ge,body:JSON.stringify(De)}).then(Pe=>Pe.json())})({serverURL:s,lang:p,token:(q=c.value)==null?void 0:q.token,comment:g}).then(j=>{if(R.value=!1,d.update({nick:g.nick,link:g.link,mail:g.mail}),j.errmsg)return alert(j.errmsg);n("submit",j.data),r.editor="",$.value="",t.replyId&&n("cancel-reply")}).catch(j=>{R.value=!1,alert(j.message)})},J=s=>{v.value.contains(s.target)||y.value.contains(s.target)||(h.value=!1)};return e.watch(()=>r.editor,s=>{const{highlighter:p,texRenderer:f}=o.value;E.value=s,$.value=ot(s,{emojiMap:l.value.map,highlighter:p,texRenderer:f}),V.value=(b=>(k=>k.match(/[\w\d\s\u00C0-\u024F]+/giu)||[])(b).reduce((k,g)=>k+(g.trim()===""?0:g.trim().split(/\s+/u).length),0)+(k=>k.match(/[\u4E00-\u9FA5]/gu)||[])(b).length)(s),u.value&&(s?ye.default(u.value):ye.default.destroy(u.value))},{immediate:!0}),e.watch(()=>o.value.emoji,s=>s.then(p=>{l.value=p}),{immediate:!0}),e.watch([o,V],([s,p])=>{const{wordLimit:f}=s;f?p<f[0]&&f[0]!==0?(S.value=f[0],L.value=!1):p>f[1]?(S.value=f[1],L.value=!1):(S.value=f[1],L.value=!0):(S.value=0,L.value=!0)},{immediate:!0}),e.onMounted(()=>{document.body.addEventListener("click",J)}),e.onUnmounted(()=>{document.body.removeEventListener("click",J)}),{config:o,locale:N,insert:T,onChange:()=>{const s=i.value;s.files&&U.value&&z(s.files[0]).then(()=>{s.value=""})},onDrop:s=>{var p;if((p=s.dataTransfer)!=null&&p.items){const f=be(s.dataTransfer.items);f&&U.value&&(z(f),s.preventDefault())}},onKeyDown:s=>{const p=s.key;(s.ctrlKey||s.metaKey)&&p==="Enter"&&A()},onPaste:s=>{if(s.clipboardData){const p=be(s.clipboardData.items);p&&U.value&&z(p)}},onLogin:s=>{s.preventDefault();const{lang:p,serverURL:f}=o.value,b=(window.innerWidth-450)/2,k=(window.innerHeight-450)/2,g=window.open(`${f}/ui/login?lng=${encodeURIComponent(p)}`,"_blank",`width=450,height=450,left=${b},top=${k},scrollbars=no,resizable=no,status=no,location=no,toolbar=no,menubar=no`);g==null||g.postMessage({type:"TOKEN",data:null},"*");const x=({data:B})=>{B&&B.type==="userInfo"&&B.data.token&&(g==null||g.close(),m(B.data),(B.data.remember?localStorage:sessionStorage).setItem("WALINE_USER",JSON.stringify(B.data)),window.removeEventListener("message",x))};window.addEventListener("message",x)},onLogout:()=>{m({}),localStorage.setItem("WALINE_USER","null"),sessionStorage.setItem("WALINE_USER","null")},onProfile:s=>{var x;s.preventDefault();const{lang:p,serverURL:f}=o.value,b=(window.innerWidth-800)/2,k=(window.innerHeight-800)/2;(x=window.open(`${f}/ui/profile?lng=${encodeURIComponent(p)}`,"_blank",`width=800,height=800,left=${b},top=${k},scrollbars=no,resizable=no,status=no,location=no,toolbar=no,menubar=no`))==null||x.postMessage({type:"TOKEN",data:c.value.token},"*");const g=({data:B})=>{B&&B.type==="profile"&&(m(Object.assign({},c.value,B)),[localStorage,sessionStorage].filter(M=>M.getItem("WALINE_USER")).forEach(M=>M.setItem("WALINE_USER",JSON.stringify(c))),window.removeEventListener("message",g))};window.addEventListener("message",g)},submitComment:A,isLogin:_,userInfo:c,isSubmitting:R,wordNumber:V,wordLimit:S,isWordNumberLegal:L,inputs:r,emoji:l,emojiTabIndex:w,showEmoji:h,canUploadImage:U,previewText:$,showPreview:C,inputRefs:a,editorRef:u,emojiButtonRef:v,emojiPopupRef:y,imageUploadRef:i}}});const lt={class:"wl-comment"},at={key:0,class:"wl-login-info"},it={class:"wl-avatar"},ct=["title"],st=["src"],mt=["textContent"],dt={class:"wl-panel"},ut=["for","textContent"],pt=["id","name","type","onUpdate:modelValue"],gt=["placeholder"],ht=["innerHTML"],vt={class:"wl-footer"},ft={class:"wl-actions"},yt={href:"https://guides.github.com/features/mastering-markdown/",title:"Markdown Guide","aria-label":"Markdown is supported",class:"wl-action",target:"_blank",rel:"noreferrer"},kt=["title"],wt=["title"],Ct=["title"],bt={class:"wl-info"},Et={class:"wl-text-number"},Bt={key:0},Nt=e.createTextVNode(" \xA0/\xA0 "),$t=["textContent"],St=["textContent"],Lt=["disabled"],It={key:0,class:"wl-tab-wrapper"},Vt=["title","onClick"],Rt=["src","alt"],xt={key:0,class:"wl-tabs"},jt=["onClick"],Ut=["src","alt","title"],zt=["title"];Z.render=function(t,n,o,r,d,c){const m=e.resolveComponent("CloseIcon"),a=e.resolveComponent("MarkdownIcon"),u=e.resolveComponent("EmojiIcon"),i=e.resolveComponent("ImageIcon"),v=e.resolveComponent("PreviewIcon"),y=e.resolveComponent("LoadingIcon");return e.openBlock(),e.createElementBlock("div",lt,[t.config.login!=="disable"&&t.isLogin?(e.openBlock(),e.createElementBlock("div",at,[e.createElementVNode("div",it,[e.createElementVNode("button",{class:"wl-logout-btn",title:t.locale.logout,onClick:n[0]||(n[0]=(...l)=>t.onLogout&&t.onLogout(...l))},[e.createVNode(m,{size:14})],8,ct),e.createElementVNode("img",{src:t.userInfo.avatar,alt:"avatar"},null,8,st)]),e.createElementVNode("a",{href:"#",class:"wl-login-nick","aria-label":"Profile",onClick:n[1]||(n[1]=(...l)=>t.onProfile&&t.onProfile(...l)),textContent:e.toDisplayString(t.userInfo.display_name)},null,8,mt)])):e.createCommentVNode("v-if",!0),e.createElementVNode("div",dt,[t.config.login!=="force"&&t.config.meta.length&&!t.isLogin?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["wl-header",`item${t.config.meta.length}`])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.config.meta,l=>(e.openBlock(),e.createElementBlock("div",{class:"wl-header-item",key:l},[e.createElementVNode("label",{for:l,textContent:e.toDisplayString(t.locale[l]+(t.config.requiredMeta.includes(l)||!t.config.requiredMeta.length?"":`(${t.locale.optional})`))},null,8,ut),e.withDirectives(e.createElementVNode("input",{ref_for:!0,ref:w=>{w&&(t.inputRefs[l]=w)},id:`wl-${l}`,class:e.normalizeClass(["wl-input",`wl-${l}`]),name:l,type:l==="mail"?"email":"text","onUpdate:modelValue":w=>t.inputs[l]=w},null,10,pt),[[e.vModelDynamic,t.inputs[l]]])]))),128))],2)):e.createCommentVNode("v-if",!0),e.withDirectives(e.createElementVNode("textarea",{class:"wl-editor",ref:"editorRef",id:"wl-edit",placeholder:t.replyUser?`@${t.replyUser}`:t.locale.placeholder,"onUpdate:modelValue":n[2]||(n[2]=l=>t.inputs.editor=l),onKeydown:n[3]||(n[3]=(...l)=>t.onKeyDown&&t.onKeyDown(...l)),onDrop:n[4]||(n[4]=(...l)=>t.onDrop&&t.onDrop(...l)),onPaste:n[5]||(n[5]=(...l)=>t.onPaste&&t.onPaste(...l))},null,40,gt),[[e.vModelText,t.inputs.editor]]),e.createElementVNode("div",{class:"wl-preview",style:e.normalizeStyle({display:t.showPreview?"block":"none"})},[e.createElementVNode("h4",null,e.toDisplayString(t.locale.preview)+":",1),e.createElementVNode("div",{class:"wl-content",innerHTML:t.previewText},null,8,ht)],4),e.createElementVNode("div",vt,[e.createElementVNode("div",ft,[e.createElementVNode("a",yt,[e.createVNode(a)]),e.createElementVNode("button",{ref:"emojiButtonRef",class:e.normalizeClass(["wl-action",{actived:t.showEmoji}]),title:t.locale.emoji,onClick:n[6]||(n[6]=l=>t.showEmoji=!t.showEmoji)},[e.createVNode(u)],10,kt),e.createElementVNode("input",{ref:"imageUploadRef",class:"upload",id:"wl-image-upload",type:"file",accept:".png,.jpg,.jpeg,.webp,.bmp,.gif",onChange:n[7]||(n[7]=(...l)=>t.onChange&&t.onChange(...l))},null,544),t.canUploadImage?(e.openBlock(),e.createElementBlock("label",{key:0,for:"wl-image-upload",class:"wl-action",title:t.locale.uploadImage},[e.createVNode(i)],8,wt)):e.createCommentVNode("v-if",!0),e.createElementVNode("button",{class:e.normalizeClass(["wl-action",{actived:t.showPreview}]),title:t.locale.preview,onClick:n[8]||(n[8]=l=>t.showPreview=!t.showPreview)},[e.createVNode(v)],10,Ct)]),e.createElementVNode("div",bt,[e.createElementVNode("div",Et,[e.createTextVNode(e.toDisplayString(t.wordNumber)+" ",1),t.config.wordLimit?(e.openBlock(),e.createElementBlock("span",Bt,[Nt,e.createElementVNode("span",{class:e.normalizeClass({illegal:!t.isWordNumberLegal}),textContent:e.toDisplayString(t.wordLimit)},null,10,$t)])):e.createCommentVNode("v-if",!0),e.createTextVNode(" \xA0"+e.toDisplayString(t.locale.word),1)]),t.config.login==="disable"||t.isLogin?e.createCommentVNode("v-if",!0):(e.openBlock(),e.createElementBlock("button",{key:0,class:"wl-btn",onClick:n[9]||(n[9]=(...l)=>t.onLogin&&t.onLogin(...l)),textContent:e.toDisplayString(t.locale.login)},null,8,St)),t.config.login!=="force"||t.isLogin?(e.openBlock(),e.createElementBlock("button",{key:1,class:"wl-btn primary",title:"Cmd|Ctrl + Enter",disabled:t.isSubmitting,onClick:n[10]||(n[10]=(...l)=>t.submitComment&&t.submitComment(...l))},[t.isSubmitting?(e.openBlock(),e.createBlock(y,{key:0,size:16})):(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createTextVNode(e.toDisplayString(t.locale.submit),1)],2112))],8,Lt)):e.createCommentVNode("v-if",!0)]),e.createElementVNode("div",{ref:"emojiPopupRef",class:e.normalizeClass(["wl-emoji-popup",{display:t.showEmoji}])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.emoji.tabs,(l,w)=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:l.name},[w===t.emojiTabIndex?(e.openBlock(),e.createElementBlock("div",It,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.items,h=>(e.openBlock(),e.createElementBlock("button",{key:h,title:h,onClick:C=>t.insert(`:${h}:`)},[t.showEmoji?(e.openBlock(),e.createElementBlock("img",{key:0,class:"wl-emoji",src:t.emoji.map[h],alt:h,loading:"lazy",referrerPolicy:"no-referrer"},null,8,Rt)):e.createCommentVNode("v-if",!0)],8,Vt))),128))])):e.createCommentVNode("v-if",!0)],64))),128)),t.emoji.tabs.length>1?(e.openBlock(),e.createElementBlock("div",xt,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.emoji.tabs,(l,w)=>(e.openBlock(),e.createElementBlock("button",{key:l.name,class:e.normalizeClass(["wl-tab",{active:t.emojiTabIndex===w}]),onClick:h=>t.emojiTabIndex=w},[e.createElementVNode("img",{class:"wl-emoji",src:l.icon,alt:l.name,title:l.name,loading:"lazy",referrerPolicy:"no-referrer"},null,8,Ut)],10,jt))),128))])):e.createCommentVNode("v-if",!0)],2)])]),t.replyId?(e.openBlock(),e.createElementBlock("button",{key:1,class:"wl-close",title:t.locale.cancelReply,onClick:n[11]||(n[11]=l=>t.$emit("cancel-reply"))},[e.createVNode(m,{size:24})],8,zt)):e.createCommentVNode("v-if",!0)])},Z.__file="src/components/CommentBox.vue";var de=e.defineComponent({props:{comment:{type:Object,required:!0},rootId:{type:String,required:!0},reply:{type:Object}},components:{CommentBox:Z,ReplyIcon:()=>e.h("svg",{viewBox:"0 0 1024 1024",width:"18",height:"18"},e.h("path",{d:"M1019.2 720C1001.6 625.6 968 566.4 904 497.6c-89.6-89.6-214.4-150.4-347.2-176v-120c0-25.6-8-51.2-25.6-64-33.6-30.4-81.6-30.4-112-4.8L33.6 441.6C12.8 459.2 0 484.8 0 510.4c0 25.6 12.8 51.2 30.4 68.8l385.6 312c17.6 12.8 33.6 17.6 51.2 17.6 12.8 0 25.6-4.8 38.4-8C536 888 552 857.6 552 824v-99.2c124.8 20.8 248 86.4 339.2 140.8 25.6 17.6 59.2 17.6 89.6 0 25.6-17.6 43.2-46.4 43.2-76.8 0-33.6 0-56-4.8-68.8zm-500.8-89.6-46.4-4.8v193.6L86.4 510.4 472 201.6V400l38.4 4.8c128 12.8 248 68.8 334.4 153.6 51.2 56 76.8 102.4 94.4 179.2 0 4.8 4.8 20.8 4.8 51.2C835.2 720 672 640 518.4 630.4z",fill:"currentColor"})),VerifiedIcon:()=>e.h("svg",{class:"verified-icon",viewBox:"0 0 1024 1024",width:"14",height:"14"},e.h("path",{d:"m894.4 461.56-54.4-63.2c-10.4-12-18.8-34.4-18.8-50.4v-68c0-42.4-34.8-77.2-77.2-77.2h-68c-15.6 0-38.4-8.4-50.4-18.8l-63.2-54.4c-27.6-23.6-72.8-23.6-100.8 0l-62.8 54.8c-12 10-34.8 18.4-50.4 18.4h-69.2c-42.4 0-77.2 34.8-77.2 77.2v68.4c0 15.6-8.4 38-18.4 50l-54 63.6c-23.2 27.6-23.2 72.4 0 100l54 63.6c10 12 18.4 34.4 18.4 50v68.4c0 42.4 34.8 77.2 77.2 77.2h69.2c15.6 0 38.4 8.4 50.4 18.8l63.2 54.4c27.6 23.6 72.8 23.6 100.8 0l63.2-54.4c12-10.4 34.4-18.8 50.4-18.8h68c42.4 0 77.2-34.8 77.2-77.2v-68c0-15.6 8.4-38.4 18.8-50.4l54.4-63.2c23.2-27.6 23.2-73.2-.4-100.8zm-216-25.2-193.2 193.2a30 30 0 0 1-42.4 0l-96.8-96.8a30.16 30.16 0 0 1 0-42.4c11.6-11.6 30.8-11.6 42.4 0l75.6 75.6 172-172c11.6-11.6 30.8-11.6 42.4 0 11.6 11.6 11.6 30.8 0 42.4z",fill:"#27ae60"}))},emits:["submit","reply"],setup(t){const n=e.inject("config"),o=e.computed(()=>n.value.locale),r=e.computed(()=>{let{link:c}=t.comment;return c?Ue(c)?c:`https://${c}`:""}),d=e.computed(()=>{var c;return t.comment.objectId===((c=t.reply)==null?void 0:c.objectId)});return{config:n,locale:o,isReplyingCurrent:d,link:r,timeAgo:rt}}});const At=["id"],Mt={class:"wl-user","aria-hidden":"true"},Tt=["src"],Dt={class:"wl-card"},Pt={class:"wl-head"},Ot=["href"],_t={key:1,class:"wl-nick"},qt=["textContent"],Ht=["textContent"],Wt=["textContent"],Ft=["title"],Jt={class:"wl-meta","aria-hidden":"true"},Kt=["textContent"],Yt=["textContent"],Gt=["innerHTML"],Qt={key:0,class:"wl-reply-wrapper"},Xt={key:1,class:"wl-quote"};de.render=function(t,n,o,r,d,c){const m=e.resolveComponent("VerifiedIcon"),a=e.resolveComponent("ReplyIcon"),u=e.resolveComponent("CommentBox"),i=e.resolveComponent("CommentCard",!0);return e.openBlock(),e.createElementBlock("div",{class:"wl-item",id:t.comment.objectId},[e.createElementVNode("div",Mt,[t.comment.avatar?(e.openBlock(),e.createElementBlock("img",{key:0,src:t.comment.avatar},null,8,Tt)):e.createCommentVNode("v-if",!0),t.comment.type?(e.openBlock(),e.createBlock(m,{key:1})):e.createCommentVNode("v-if",!0)]),e.createElementVNode("div",Dt,[e.createElementVNode("div",Pt,[t.link?(e.openBlock(),e.createElementBlock("a",{key:0,class:"wl-nick",href:t.link,target:"_blank",rel:"nofollow noreferrer"},e.toDisplayString(t.comment.nick),9,Ot)):(e.openBlock(),e.createElementBlock("span",_t,e.toDisplayString(t.comment.nick),1)),t.comment.type==="administrator"?(e.openBlock(),e.createElementBlock("span",{key:2,class:"wl-badge",textContent:e.toDisplayString(t.locale.admin)},null,8,qt)):e.createCommentVNode("v-if",!0),t.comment.sticky?(e.openBlock(),e.createElementBlock("span",{key:3,class:"wl-badge",textContent:e.toDisplayString(t.locale.sticky)},null,8,Ht)):e.createCommentVNode("v-if",!0),e.createElementVNode("span",{class:"wl-time",textContent:e.toDisplayString(t.timeAgo(t.comment.insertedAt,t.locale))},null,8,Wt),e.createElementVNode("button",{class:e.normalizeClass(["wl-reply",{active:t.isReplyingCurrent}]),title:t.isReplyingCurrent?t.locale.cancelReply:t.locale.reply,onClick:n[0]||(n[0]=v=>t.$emit("reply",t.isReplyingCurrent?null:t.comment))},[e.createVNode(a)],10,Ft)]),e.createElementVNode("div",Jt,[t.comment.browser?(e.openBlock(),e.createElementBlock("span",{key:0,textContent:e.toDisplayString(t.comment.browser)},null,8,Kt)):e.createCommentVNode("v-if",!0),t.comment.os?(e.openBlock(),e.createElementBlock("span",{key:1,textContent:e.toDisplayString(t.comment.os)},null,8,Yt)):e.createCommentVNode("v-if",!0)]),e.createElementVNode("div",{class:"wl-content",innerHTML:t.comment.comment},null,8,Gt),t.isReplyingCurrent?(e.openBlock(),e.createElementBlock("div",Qt,[e.createVNode(u,{replyId:t.comment.objectId,replyUser:t.comment.nick,rootId:t.rootId,onSubmit:n[1]||(n[1]=v=>t.$emit("submit",v)),onCancelReply:n[2]||(n[2]=v=>t.$emit("reply",null))},null,8,["replyId","replyUser","rootId"])])):e.createCommentVNode("v-if",!0),t.comment.children?(e.openBlock(),e.createElementBlock("div",Xt,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.comment.children,v=>(e.openBlock(),e.createBlock(i,{key:v.objectId,comment:v,reply:t.reply,rootId:t.rootId,onReply:n[3]||(n[3]=y=>t.$emit("reply",y)),onSubmit:n[4]||(n[4]=y=>t.$emit("submit",y))},null,8,["comment","reply","rootId"]))),128))])):e.createCommentVNode("v-if",!0)])],8,At)},de.__file="src/components/CommentCard.vue";var ue=e.defineComponent({name:"Waline-Root",components:{CommentBox:Z,CommentCard:de,LoadingIcon:Te},props:{serverURL:{type:String,required:!0},path:{type:String,required:!0},meta:{type:Array},requiredMeta:{type:Array},visitor:{type:Boolean},dark:{type:[String,Boolean]},lang:{type:String},locale:{type:Object},pageSize:{type:Number},wordLimit:{type:[Number,Array]},emoji:{type:Array},login:{type:String},highlighter:{type:Function},imageUploader:{type:[Function,!1]},texRender:{type:Function}},setup(t){const n=e.computed(()=>(s=>{var p=s,{serverURL:h,path:C=location.pathname,lang:$="zh-CN",locale:V,emoji:S=["https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/weibo"],meta:L=["nick","mail","link"],requiredMeta:E=[],pageSize:R=10,wordLimit:N,imageUploader:_,highlighter:U,texRenderer:T,copyright:z=!0,login:A="enable"}=p,J=G(p,["serverURL","path","lang","locale","emoji","meta","requiredMeta","pageSize","wordLimit","imageUploader","highlighter","texRenderer","copyright","login"]);return D({serverURL:Ge(h),path:xe(C),lang:$,locale:D(D({},me[$]||me["zh-CN"]),typeof V=="object"?V:{}),emoji:(f=S,Promise.all(f.map(b=>typeof b=="string"?Ye(je(b)):Promise.resolve(b))).then(b=>{const k={tabs:[],map:{}};return b.forEach(g=>{const{name:x,folder:B,icon:M,prefix:P,type:q,items:j}=g;k.tabs.push({name:x,icon:Ce(M,B,P,q),items:j.map(K=>{const H=`${P||""}${K}`;return k.map[H]=Ce(K,B,P,q),H})})}),k})),wordLimit:Array.isArray(N)?N:!!N&&[0,N],meta:se(L),requiredMeta:se(E),pageSize:R,login:A,imageUploader:ae(_,Ie),highlighter:ae(U,We.default),texRenderer:ae(T,Ve),copyright:z},J);var f})(t)),{userInfo:o}=pe(),r=e.ref("loading"),d=e.ref(0),c=e.ref(1),m=e.ref(0),a=e.ref([]),u=e.ref(null),i=e.computed(()=>{return typeof(h=n.value.dark)=="string"?h==="auto"?`@media(prefers-color-scheme:dark){body${ie}}`:`${h}${ie}`:h===!0?`:root${ie}`:"";var h});let v,y;const l=h=>{var L;const{serverURL:C,path:$,pageSize:V}=n.value,S=new AbortController;r.value="loading",v==null||v(),(({serverURL:E,path:R,page:N,pageSize:_,signal:U,token:T})=>{const z={};return T&&(z.Authorization=`Bearer ${T}`),fetch(`${E}/comment?path=${encodeURIComponent(R)}&pageSize=${_}&page=${N}`,{signal:U,headers:z}).then(A=>A.json()).then(A=>F(A,"comment list"))})({serverURL:C,path:$,pageSize:V,page:h,signal:S.signal,token:(L=o.value)==null?void 0:L.token}).then(E=>{r.value="success",d.value=E.count,a.value.push(...E.data),c.value=h,m.value=E.totalPages}).catch(E=>{E.name!=="AbortError"&&(console.error(E.message),r.value="error")}),v=S.abort.bind(S)},w=()=>{d.value=0,a.value=[],l(1)};return e.provide("config",n),e.watch(()=>t.path,w),e.onMounted(()=>{var C;w();const h=document.createElement("style");h.innerText=i.value,(C=document.querySelector("[data-waline]"))==null||C.appendChild(h),y=e.watchEffect(()=>{h.innerText=i.value})}),e.onBeforeUnmount(()=>y()),{config:n,darkmodeStyle:i,i18n:e.computed(()=>n.value.locale),status:r,count:d,page:c,totalPages:m,data:a,reply:u,loadMore:()=>l(c.value+1),refresh:w,onReply:h=>{u.value=h},onSubmit:h=>{if(h.rid){const C=a.value.find(({objectId:$})=>$===h.rid);if(!C)return;Array.isArray(C.children)||(C.children=[]),C.children.push(h)}else a.value.unshift(h)},version:"2.0.0-alpha.0"}}});const Zt={"data-waline":""},en={class:"wl-count"},tn=["textContent"],nn={key:1,class:"wl-action"},on=["textContent"],rn={key:2,class:"wl-loading"},ln=["textContent"],an={key:1,class:"wl-cards"},cn={key:2,class:"wl-more"},sn=["textContent"],mn={key:4,class:"wl-power"},dn=e.createTextVNode(" Powered by "),un=e.createElementVNode("a",{href:"https://github.com/walinejs/waline",target:"_blank",rel:"noreferrer"}," Waline ",-1);ue.render=function(t,n,o,r,d,c){const m=e.resolveComponent("CommentBox"),a=e.resolveComponent("LoadingIcon"),u=e.resolveComponent("CommentCard");return e.openBlock(),e.createElementBlock("div",Zt,[t.reply?e.createCommentVNode("v-if",!0):(e.openBlock(),e.createBlock(m,{key:0,onSubmit:t.onSubmit},null,8,["onSubmit"])),e.createElementVNode("div",en,[t.count?(e.openBlock(),e.createElementBlock("span",{key:0,class:"wl-num",textContent:e.toDisplayString(t.count)},null,8,tn)):e.createCommentVNode("v-if",!0),e.createTextVNode(" "+e.toDisplayString(t.i18n.comment),1)]),t.status==="error"?(e.openBlock(),e.createElementBlock("div",nn,[e.createElementVNode("button",{type:"button",class:"wl-btn",onClick:n[0]||(n[0]=(...i)=>t.refresh&&t.refresh(...i)),textContent:e.toDisplayString(t.i18n.refresh)},null,8,on)])):t.status==="loading"?(e.openBlock(),e.createElementBlock("div",rn,[e.createVNode(a,{size:30})])):(e.openBlock(),e.createElementBlock(e.Fragment,{key:3},[t.data.length?(e.openBlock(),e.createElementBlock("div",an,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.data,i=>(e.openBlock(),e.createBlock(u,{key:i.objectId,"root-id":i.objectId,comment:i,reply:t.reply,onReply:t.onReply,onSubmit:t.onSubmit},null,8,["root-id","comment","reply","onReply","onSubmit"]))),128))])):(e.openBlock(),e.createElementBlock("div",{key:0,class:"wl-empty",textContent:e.toDisplayString(t.i18n.sofa)},null,8,ln)),e.createCommentVNode(" Load more button "),t.page<t.totalPages?(e.openBlock(),e.createElementBlock("div",cn,[e.createElementVNode("button",{type:"button",class:"wl-btn",onClick:n[1]||(n[1]=(...i)=>t.loadMore&&t.loadMore(...i)),textContent:e.toDisplayString(t.i18n.more)},null,8,sn)])):e.createCommentVNode("v-if",!0)],64)),e.createCommentVNode(" Copyright Information "),t.config.copyright?(e.openBlock(),e.createElementBlock("div",mn,[dn,un,e.createTextVNode(" v"+e.toDisplayString(t.version),1)])):e.createCommentVNode("v-if",!0)])},ue.__file="src/components/Waline.vue";const $e=(t,n)=>{n.forEach((o,r)=>{o.innerText=t[r].toString()})},Se=({serverURL:t,path:n=window.location.pathname,selector:o=".waline-pageview-count",update:r=!0})=>{const d=new AbortController,c=Array.from(document.querySelectorAll(o)),m=u=>{const i=Be(u);return i!==null&&n!==i},a=u=>Xe({serverURL:t,paths:u.map(i=>Be(i)||n),signal:d.signal}).then(i=>$e(i,u)).catch(ze);if(r){const u=c.filter(v=>!m(v)),i=c.filter(m);Ze({serverURL:t,path:n}).then(v=>$e(new Array(u.length).fill(v),u)),i.length&&a(i)}else a(c);return d.abort.bind(d)};I.RecentComments=({el:t,serverURL:n,count:o})=>{var c;const r=Ee(t),d=new AbortController;return(({serverURL:m,count:a,signal:u,token:i})=>{const v={};return i&&(v.Authorization=`Bearer ${i}`),fetch(`${m}/comment?type=recent&count=${a}`,{signal:u,headers:v}).then(y=>y.json()).then(y=>F(y,"recent comment"))})({serverURL:n,count:o,signal:d.signal,token:(c=Me())==null?void 0:c.token}).then(m=>r&&m.length?(r.innerHTML=`<ul class="wl-recent-list">${m.map(a=>`<li class="wl-recent-item"><a href="${a.url}">${a.nick}</a>\uFF1A${a.comment}</li>`).join("")}</ul>`,{comments:m,destroy:()=>{d.abort(),r.innerHTML=""}}):{comments:m,destroy:()=>d.abort()})},I.commentCount=Ne,I.defaultLang="zh-CN",I.defaultTexRenderer=Ve,I.defaultUploadImage=Ie,I.getMeta=se,I.init=c=>{var m=c,{el:t="#waline",path:n=window.location.pathname,comment:o=!1,pageview:r=!1}=m,d=G(m,["el","path","comment","pageview"]);const a=t?Ee(t):null;if(t&&!a)throw new Error("Option 'el' do not match any domElement!");if(!d.serverURL)throw new Error("Option 'serverURL' is missing!");const u=e.reactive(D({},d)),i=e.reactive({comment:o,pageview:r,path:n}),v=()=>{i.comment&&Ne({serverURL:u.serverURL,path:i.path,selector:typeof i.comment=="string"?i.comment:void 0})},y=()=>{i.pageview&&Se({serverURL:u.serverURL,path:i.path,selector:typeof i.pageview=="string"?i.pageview:void 0})},l=a?e.createApp(()=>e.h(ue,D({path:i.path},u))):null;l&&l.mount(a),v(),y();const w=e.watchEffect(v),h=e.watchEffect(y);return{el:a,update:L=>{var E=L,{comment:C,pageview:$,path:V=window.location.pathname}=E,S=G(E,["comment","pageview","path"]);Object.entries(S).map(([R,N])=>{u[R]=N}),i.path=V,C!==void 0&&(i.comment=C),$!==void 0&&(i.pageview=$)},destroy:()=>{l==null||l.unmount(),w(),h()}}},I.locales=me,I.pageviewCount=Se,I.version="2.0.0-alpha.0"});export default pn();
