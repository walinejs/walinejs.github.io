import{_ as n}from"./plugin-vue_export-helper-x3n3nnut.js";import{o as a,c as t,a as s,b as e,d as o}from"./app-WI4TDVOk.js";const p={},c=e("p",null,"Waline supports displaying the number of comments separately in the non-comment area.",-1),l=o(`<h2 id="automatically-update" tabindex="-1"><a class="header-anchor" href="#automatically-update"><span>Automatically Update</span></a></h2><p>You can enable comment counting in the <code>init</code> function by setting the <code>comment</code> option to <code>true</code>.</p><div class="language-html" data-ext="html" data-title="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">import</span> <span class="token punctuation">{</span> init <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;https://unpkg.com/@waline/client@v3/dist/waline.js&#39;</span><span class="token punctuation">;</span>

  <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">&#39;#waline&#39;</span><span class="token punctuation">,</span>
    <span class="token comment">// ...</span>
    <span class="token literal-property property">comment</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// enable comment counting</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Waline will try to fill in or update comment count whenever you called <code>init</code> function or update the path.</p><p>waline finds the elements having <code>waline-comment-count</code> class in the page, and get their <code>data-path</code> attribute as the query condition. And fill it with the obtained value:</p><div class="language-html" data-ext="html" data-title="html"><pre class="language-html"><code><span class="token comment">&lt;!-- data-path will be the query condition --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">data-path</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>&lt;Your/Path/Name&gt;<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>waline-comment-count<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span> comments
</code></pre></div><p>If you need a different selector, you can set the <code>comment</code> option to that selector.</p><p>Every time you call <code>WalineInstance.update()</code>, Waline will search the page content and automatically update the comment count.</p><div class="hint-container tip"><p class="hint-container-title">Examples</p><div class="language-html" data-ext="html" data-title="html"><pre class="language-html"><code>The current page has
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>waline-comment-count<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-path</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/en/cookbook/comment<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
comments.
</code></pre></div><p>The current page has <span data-path="/en/cookbook/comment" class="waline-comment-count"></span> comments.</p></div><h2 id="manual-update" tabindex="-1"><a class="header-anchor" href="#manual-update"><span>Manual Update</span></a></h2><p>Besides automatically update via the <code>init</code> function, you can manually update the current page&#39;s comment count via the <code>commentCount</code> API:</p><div class="language-html" data-ext="html" data-title="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">import</span> <span class="token punctuation">{</span> commentCount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;https://unpkg.com/@waline/client@v3/dist/comment.js&#39;</span><span class="token punctuation">;</span>

  <span class="token function">commentCount</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    serverURL<span class="token punctuation">,</span>
    path<span class="token punctuation">,</span>

    <span class="token comment">// optional, for custom selectors, defaults to \`&#39;.waline-pageview-count&#39;\`</span>
    <span class="token comment">// selector: &#39;.waline-pageview-count&#39;,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="hint-container info"><p class="hint-container-title">Aborting</p><p>Since the comment count fetch is an asynchronous network operation, you may need to cancel an ongoing comment count update operation in certain circumstances.</p><p><code>commentCount</code> returns a function that can be called to cancel the update:</p><div class="language-javascript" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> abort <span class="token operator">=</span> Waline<span class="token punctuation">.</span><span class="token function">commentCount</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">serverURL</span><span class="token operator">:</span> <span class="token string">&#39;&lt;YOUR_SERVER_URL&gt;&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">path</span><span class="token operator">:</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>pathname<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// After 500ms, if the network request has not been completed, cancel this operation</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">abort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div><h2 id="import-counter-only" tabindex="-1"><a class="header-anchor" href="#import-counter-only"><span>Import Counter Only</span></a></h2><p>Sometimes, you may want to display the comment count of some pages in the article list or homepage, but do not want to load the entire Waline. At this point you can use a Gzip &lt; 1KB <code>comment</code> module:</p><div class="language-html" data-ext="html" data-title="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">import</span> <span class="token punctuation">{</span> commentCount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;https://unpkg.com/@waline/client@v3/dist/comment.js&#39;</span><span class="token punctuation">;</span>

  <span class="token function">commentCount</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    serverURL<span class="token punctuation">,</span>
    path<span class="token punctuation">,</span>

    <span class="token comment">// optional, for custom selectors, defaults to \`&#39;.waline-pageview-count&#39;\`</span>
    <span class="token comment">// selector: &#39;.waline-pageview-count&#39;,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div>`,16);function u(i,r){return a(),t("div",null,[c,s(" more "),l])}const d=n(p,[["render",u],["__file","comment.html.vue"]]),h=JSON.parse('{"path":"/en/guide/features/comment.html","title":"Comment Counter","lang":"en-US","frontmatter":{"title":"Comment Counter","icon":"counter","redirectFrom":"/en/guide/client/comment.html","description":"Waline supports displaying the number of comments separately in the non-comment area. Automatically Update You can enable comment counting in the init function by setting the co...","head":[["link",{"rel":"alternate","hreflang":"zh-cn","href":"https://waline.js.org/guide/features/comment.html"}],["meta",{"property":"og:url","content":"https://waline.js.org/en/guide/features/comment.html"}],["meta",{"property":"og:site_name","content":"Waline"}],["meta",{"property":"og:title","content":"Comment Counter"}],["meta",{"property":"og:description","content":"Waline supports displaying the number of comments separately in the non-comment area. Automatically Update You can enable comment counting in the init function by setting the co..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:locale:alternate","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-01-07T15:40:02.000Z"}],["meta",{"property":"article:modified_time","content":"2024-01-07T15:40:02.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Comment Counter\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-01-07T15:40:02.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"Automatically Update","slug":"automatically-update","link":"#automatically-update","children":[]},{"level":2,"title":"Manual Update","slug":"manual-update","link":"#manual-update","children":[]},{"level":2,"title":"Import Counter Only","slug":"import-counter-only","link":"#import-counter-only","children":[]}],"git":{"createdTime":1669825130000,"updatedTime":1704642002000,"contributors":[{"name":"Mr.Hope","email":"mister-hope@outlook.com","commits":1},{"name":"Mr.Hope","email":"zhangbowang1998@gmail.com","commits":1}]},"readingTime":{"minutes":1.24,"words":373},"filePathRelative":"en/guide/features/comment.md","localizedDate":"November 30, 2022","autoDesc":true}');export{d as comp,h as data};
