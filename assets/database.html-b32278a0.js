import{_ as r,X as l,Y as c,Z as h,$ as t,a1 as e,a2 as d,a3 as i,a0 as n,C as a}from"./framework-4b90706e.js";const _={},p=t("p",null,"除了官方默认的 LeanCloud 之外，Waline 还支持多种数据库，包括 MySQL, PostgreSQL, SQLite 以及 MongoDB。",-1),b=t("p",null,"你只需配置对应的数据库的环境变量，Waline 会自动根据你配置的环境变量切换到对应的数据存储服务。",-1),u=t("h2",{id:"mongodb",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#mongodb","aria-hidden":"true"},"#"),e(" MongoDB")],-1),S={href:"https://mongodb.com",target:"_blank",rel:"noopener noreferrer"},g=n(`<table><thead><tr><th>环境变量名称</th><th>必填</th><th>默认值</th><th>备注</th></tr></thead><tbody><tr><td><code>MONGO_DB</code></td><td>✅</td><td></td><td>MongoDB 数据库名称</td></tr><tr><td><code>MONGO_USER</code></td><td>✅</td><td></td><td>MongoDB 服务的用户名</td></tr><tr><td><code>MONGO_PASSWORD</code></td><td>✅</td><td></td><td>MongoDB 服务的密码</td></tr><tr><td><code>MONGO_HOST</code></td><td></td><td>127.0.0.1</td><td>MongoDB 服务的地址，支持数组格式</td></tr><tr><td><code>MONGO_PORT</code></td><td></td><td>27017</td><td>MongoDB 服务的端口，支持数组格式</td></tr><tr><td><code>MONGO_REPLICASET</code></td><td></td><td></td><td>MongoDB 集群</td></tr><tr><td><code>MONGO_AUTHSOURCE</code></td><td></td><td></td><td>MongoDB 认证源</td></tr><tr><td><code>MONGO_OPT_SSL</code></td><td></td><td><code>false</code></td><td>是否使用 SSL 进行连接</td></tr></tbody></table><p>以下是使用 mongodb.com 官方服务的配置示例，多机需要将 <code>MONGO_HOST</code> 和 <code>MONO_PORT</code> 配置成 JSON 格式。</p><div class="language-bash" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">MONGO_HOST</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;cluster0-shard-00-00.p4edw.mongodb.net&quot;</span>,<span class="token string">&quot;cluster0-shard-00-01.p4edw.mongodb.net&quot;</span>,<span class="token string">&quot;cluster0-shard-00-02.p4edw.mongodb.net&quot;</span><span class="token punctuation">]</span>
<span class="token assign-left variable">MONGO_PORT</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">27017,27017</span>,27017,27017<span class="token punctuation">]</span>
<span class="token assign-left variable">MONGO_DB</span><span class="token operator">=</span>waline
<span class="token assign-left variable">MONGO_USER</span><span class="token operator">=</span>admin
<span class="token assign-left variable">MONGO_PASSWORD</span><span class="token operator">=</span>xxxx
<span class="token assign-left variable">MONGO_REPLICASET</span><span class="token operator">=</span>atlas-12cebf-shard-0
<span class="token assign-left variable">MONGO_AUTHSOURCE</span><span class="token operator">=</span>admin
<span class="token assign-left variable">MONGO_OPT_SSL</span><span class="token operator">=</span>true
</code></pre></div><h2 id="mysql" tabindex="-1"><a class="header-anchor" href="#mysql" aria-hidden="true">#</a> MySQL</h2>`,4),f={href:"https://planetscale.com",target:"_blank",rel:"noopener noreferrer"},O={href:"https://freedb.tech",target:"_blank",rel:"noopener noreferrer"},L={href:"https://github.com/walinejs/waline/blob/main/assets/waline.sql",target:"_blank",rel:"noopener noreferrer"},T=n('<table><thead><tr><th>环境变量名称</th><th>必填</th><th>默认值</th><th>备注</th></tr></thead><tbody><tr><td><code>MYSQL_HOST</code></td><td></td><td>127.0.0.1</td><td>MySQL 服务的地址</td></tr><tr><td><code>MYSQL_PORT</code></td><td></td><td>3306</td><td>MySQL 服务的端口</td></tr><tr><td><code>MYSQL_DB</code></td><td>✅</td><td></td><td>MySQL 数据库库名</td></tr><tr><td><code>MYSQL_USER</code></td><td>✅</td><td></td><td>MySQL 数据库的用户名</td></tr><tr><td><code>MYSQL_PASSWORD</code></td><td>✅</td><td></td><td>MySQL 数据库的密码</td></tr><tr><td><code>MYSQL_PREFIX</code></td><td></td><td><code>wl_</code></td><td>MySQL 数据表的表前缀</td></tr><tr><td><code>MYSQL_CHARSET</code></td><td></td><td><code>utf8mb4</code></td><td>MySQL 数据表的字符集</td></tr><tr><td><code>MYSQL_SSL</code></td><td></td><td><code>false</code></td><td>是否使用 SSL MYSQL 连接数据库</td></tr></tbody></table><h2 id="tidb" tabindex="-1"><a class="header-anchor" href="#tidb" aria-hidden="true">#</a> TiDB</h2>',2),k={href:"https://github.com/pingcap/tidb",target:"_blank",rel:"noopener noreferrer"},M={href:"https://tidbcloud.com/",target:"_blank",rel:"noopener noreferrer"},D=n('<table><thead><tr><th>环境变量名称</th><th>必填</th><th>默认值</th><th>备注</th></tr></thead><tbody><tr><td><code>TIDB_DB</code></td><td>✅</td><td></td><td>TiDB 数据库库名</td></tr><tr><td><code>TIDB_USER</code></td><td>✅</td><td></td><td>TiDB 数据库的用户名</td></tr><tr><td><code>TIDB_PASSWORD</code></td><td>✅</td><td></td><td>TiDB 数据库的密码</td></tr><tr><td><code>TIDB_HOST</code></td><td></td><td>127.0.0.1</td><td>TiDB 服务的地址</td></tr><tr><td><code>TIDB_PORT</code></td><td></td><td>4000</td><td>TiDB 服务的端口</td></tr><tr><td><code>TIDB_PREFIX</code></td><td></td><td><code>wl_</code></td><td>TiDB 数据表的表前缀</td></tr><tr><td><code>TIDB_CHARSET</code></td><td></td><td><code>utf8mb4</code></td><td>TiDB 数据表的字符集</td></tr></tbody></table><h2 id="sqlite" tabindex="-1"><a class="header-anchor" href="#sqlite" aria-hidden="true">#</a> SQLite</h2>',2),m={href:"https://github.com/walinejs/waline/blob/main/assets/waline.sqlite",target:"_blank",rel:"noopener noreferrer"},B=n('<table><thead><tr><th>环境变量名称</th><th>必填</th><th>默认值</th><th>备注</th></tr></thead><tbody><tr><td><code>SQLITE_PATH</code></td><td>✅</td><td></td><td>SQLite 数据库文件的路径，该路径不包含文件名本身</td></tr><tr><td><code>JWT_TOKEN</code></td><td>✅</td><td></td><td>用户登录密钥，随机字符串即可</td></tr><tr><td><code>SQLITE_DB</code></td><td></td><td>waline</td><td>SQLite 数据库文件名，若文件名变化需要修改该字段值</td></tr><tr><td><code>SQLITE_PREFIX</code></td><td></td><td><code>wl_</code></td><td>SQLite 数据表的表前缀</td></tr></tbody></table><h2 id="postgresql" tabindex="-1"><a class="header-anchor" href="#postgresql" aria-hidden="true">#</a> PostgreSQL</h2>',2),P={href:"https://supabase.com",target:"_blank",rel:"noopener noreferrer"},Q={href:"https://www.elephantsql.com/",target:"_blank",rel:"noopener noreferrer"},G={href:"https://github.com/walinejs/waline/blob/main/assets/waline.pgsql",target:"_blank",rel:"noopener noreferrer"},w=n('<table><thead><tr><th>环境变量名称</th><th>必填</th><th>默认值</th><th>备注</th></tr></thead><tbody><tr><td><code>PG_DB</code></td><td>✅</td><td></td><td>PostgreSQL 数据库库名</td></tr><tr><td><code>PG_USER</code></td><td>✅</td><td></td><td>PostgreSQL 数据库的用户名</td></tr><tr><td><code>PG_PASSWORD</code></td><td>✅</td><td></td><td>PostgreSQL 数据库的密码</td></tr><tr><td><code>PG_HOST</code></td><td></td><td>127.0.0.1</td><td>PostgreSQL 服务的地址</td></tr><tr><td><code>PG_PORT</code></td><td></td><td>3211</td><td>PostgreSQL 服务的端口</td></tr><tr><td><code>PG_PREFIX</code></td><td></td><td><code>wl_</code></td><td>PostgreSQL 数据表的表前缀</td></tr><tr><td><code>PG_SSL</code></td><td></td><td><code>false</code></td><td>是否使用 SSL 连接 PostgreSQL 数据库</td></tr></tbody></table><h2 id="cloudbase" tabindex="-1"><a class="header-anchor" href="#cloudbase" aria-hidden="true">#</a> CloudBase</h2>',2),y={href:"https://console.cloud.tencent.com/tcb/db/",target:"_blank",rel:"noopener noreferrer"},E=n("<table><thead><tr><th>环境变量名称</th><th>必填</th><th>默认值</th><th>备注</th></tr></thead><tbody><tr><td><code>TCB_ENV</code></td><td>✅</td><td></td><td>腾讯云开发环境 ID</td></tr><tr><td><code>TCB_ID</code></td><td>✅</td><td></td><td>腾讯云 API 密钥 ID</td></tr><tr><td><code>TCB_KEY</code></td><td>✅</td><td></td><td>腾讯云 API 密钥 Key</td></tr><tr><td><code>JWT_TOKEN</code></td><td></td><td></td><td>用户登录密钥，如果没有配任何环境变量的话需要配置此变量，随机字符串即可</td></tr></tbody></table>",1),R={class:"hint-container tip"},N=t("p",{class:"hint-container-title"},"提示",-1),I={href:"https://console.cloud.tencent.com/cam/capi",target:"_blank",rel:"noopener noreferrer"},x=t("h2",{id:"github",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#github","aria-hidden":"true"},"#"),e(" GitHub")],-1),q={href:"https://github.com/settings/tokens",target:"_blank",rel:"noopener noreferrer"},C=t("kbd",null,"Generate new token",-1),H=t("strong",null,"repo",-1),v=t("thead",null,[t("tr",null,[t("th",null,"环境变量名称"),t("th",null,"必填"),t("th",null,"默认值"),t("th",null,"备注")])],-1),A=t("td",null,[t("code",null,"GITHUB_TOKEN")],-1),W=t("td",null,"✅",-1),U=t("td",null,null,-1),Y={href:"https://github.com/settings/tokens",target:"_blank",rel:"noopener noreferrer"},V=t("tr",null,[t("td",null,[t("code",null,"GITHUB_REPO")]),t("td",null,"✅"),t("td"),t("td",null,[e("仓库名称，例如 "),t("code",null,"walinejs/waline")])],-1),K=t("tr",null,[t("td",null,[t("code",null,"GITHUB_PATH")]),t("td"),t("td"),t("td",null,[e("数据存储目录，例如 "),t("code",null,"data"),e(" 表示存储在 "),t("code",null,"data"),e(" 目录下，默认存在仓库根目录下")])],-1),j=t("div",{class:"hint-container warning"},[t("p",{class:"hint-container-title"},"注意"),t("p",null,"出于国内 Github 服务访问稳定性与 CSV 读取与存储性能的原因，我们不建议国内用户使用 Github 作为存储库。")],-1),F=t("h2",{id:"deta-base",tabindex:"-1"},[t("a",{class:"header-anchor",href:"#deta-base","aria-hidden":"true"},"#"),e(" Deta Base")],-1),X={href:"https://deta.space/docs/en/reference/base/about",target:"_blank",rel:"noopener noreferrer"},J=n('<table><thead><tr><th>环境变量名称</th><th>必填</th><th>默认值</th><th>备注</th></tr></thead><tbody><tr><td><code>DETA_PROJECT_KEY</code></td><td>✅</td><td></td><td>Deta 项目密钥</td></tr></tbody></table><h2 id="更多" tabindex="-1"><a class="header-anchor" href="#更多" aria-hidden="true">#</a> 更多</h2><p>除了以上数据库存储之外，waline 也能够很方便的扩展其它存储服务。</p>',3),Z={href:"https://github.com/walinejs/waline/blob/main/packages/server/src/service/storage/base.js",target:"_blank",rel:"noopener noreferrer"},$=t("code",null,"select()",-1),z=t("code",null,"add()",-1),tt=t("code",null,"update()",-1),et=t("code",null,"delete()",-1);function dt(ot,nt){const o=a("ExternalLinkIcon"),s=a("RouterLink");return l(),c("div",null,[p,b,h(" more "),u,t("p",null,[t("a",S,[e("https://mongodb.com"),d(o)]),e(" 官网免费提供了 512M 的 MongoDB 数据库支持。以下是使用 MongoDB 存储需要配置的环境变量。")]),g,t("p",null,[e("使用 MySQL 存储数据也是一个很好的选择，除了使用自建的 MySQL 服务之外，我们也可以使用 "),t("a",f,[e("PlanetScale"),d(o)]),e("，它免费提供了 10GB 的数据库支持。或者 "),t("a",O,[e("https://freedb.tech"),d(o)]),e("，它免费提供了 100M 的数据库支持。")]),t("p",null,[e("使用时请先导入 "),t("a",L,[e("waline.sql"),d(o)]),e(" 以完成表和表结构的创建，之后在项目中配置如下环境变量。")]),T,t("p",null,[t("a",k,[e("TiDB"),d(o)]),e(" 是一款开源的 NewSQL 数据库。"),t("a",M,[e("TiDB Cloud"),d(o)]),e(" 则是官方提供的在线版本，它提供了 5GB 的免费额度可供大家使用。")]),t("p",null,[e("使用时请查阅"),d(s,{to:"/guide/deploy/tidb.html"},{default:i(()=>[e("创建 TiDB 数据库")]),_:1}),e("了解初始化流程。")]),D,t("p",null,[e("使用 SQLite 时需要下载 "),t("a",m,[e("waline.sqlite"),d(o)]),e(" 文件至合适的位置。之后在项目中配置如下环境变量。")]),B,t("p",null,[t("a",P,[e("Supabase"),d(o)]),e(" 提供了 512M 的数据库支持，而"),t("a",Q,[e("elephantSQL"),d(o)]),e(" 则提供了 20M 的免费空间，对于评论服务来说绰绰有余了。如果想要使用 PostgreSQL 的也可以使用它搭建 Waline。")]),t("p",null,[e("同 MySQL，使用 PostgreSQL 也需要先导入 "),t("a",G,[e("waline.pgsql"),d(o)]),e(" 创建好表和表结构。之后在项目中配置如下环境变量。")]),w,t("p",null,[e("腾讯云开发也提供了一定的 "),t("a",y,[e("免费数据库"),d(o)]),e(" 支持，即使不部署在腾讯云开发上也可以使用。如果部署在腾讯云开发上，不需要配置任何环境变量，Waline 默认会使用云开发的数据库。如果是部署在其它地方，需要配置以下环境变量。")]),E,t("div",R,[N,t("p",null,[e("对于腾讯云 API 密钥 ID 与 Key，可以在 "),t("a",I,[e("此处"),d(o)]),e(" 申请。")])]),x,t("p",null,[e("Waline 支持将评论数据以 CSV 文件的格式存储在 GitHub 仓库中。使用 GitHub 作为数据存储需要申请 Personal access tokens，可在 "),t("a",q,[e("https://github.com/settings/tokens"),d(o)]),e(" 这里点击 "),C,e(" 进行申请，下方权限选项中勾选上 "),H,e(" 选项，用于获得仓库的读写权限。")]),t("table",null,[v,t("tbody",null,[t("tr",null,[A,W,U,t("td",null,[t("a",Y,[e("Personal access tokens"),d(o)])])]),V,K])]),j,F,t("p",null,[e("Deta 提供了 "),t("a",X,[e("Deta Base"),d(o)]),e(" 免费数据库支持，即使不部署在 Deta 上也可以使用。如果部署在 Deta 上，不需要配置任何环境变量，Waline 默认会使用 Deta Base 作为数据库存储数据。如果是部署在其它地方，需要配置以下环境变量。")]),J,t("p",null,[e("如果你想帮助 Waline 支持更多的存储服务的话，可以 Fork 项目，继承该 "),t("a",Z,[e("基类"),d(o)]),e(" 后分别实现对应存储服务的 "),$,e(", "),z,e(", "),tt,e(", "),et,e(" 方法后提交 PR 即可。")])])}const st=r(_,[["render",dt],["__file","database.html.vue"]]);export{st as default};
